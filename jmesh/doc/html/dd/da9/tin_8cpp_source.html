<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenCog Framework: /home/wondereamer/object_detection/JMeshLib-1.2/src/MESH_STRUCTURE/tin.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = '../../open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = '../../closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCog Framework&#160;<span id="projectnumber">Branch: opencog, revision 7348</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dd/da9/tin_8cpp.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">tin.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../dd/da9/tin_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* JMeshLib                                                                  *</span>
<a name="l00003"></a>00003 <span class="comment">*                                                                           *</span>
<a name="l00004"></a>00004 <span class="comment">* Consiglio Nazionale delle Ricerche                                        *</span>
<a name="l00005"></a>00005 <span class="comment">* Istituto di Matematica Applicata e Tecnologie Informatiche                *</span>
<a name="l00006"></a>00006 <span class="comment">* Sezione di Genova                                                         *</span>
<a name="l00007"></a>00007 <span class="comment">* IMATI-GE / CNR                                                            *</span>
<a name="l00008"></a>00008 <span class="comment">*                                                                           *</span>
<a name="l00009"></a>00009 <span class="comment">* Authors: Marco Attene                                                     *</span>
<a name="l00010"></a>00010 <span class="comment">*                                                                           *</span>
<a name="l00011"></a>00011 <span class="comment">* Copyright(C) 2006: IMATI-GE / CNR                                         *</span>
<a name="l00012"></a>00012 <span class="comment">*                                                                           *</span>
<a name="l00013"></a>00013 <span class="comment">* All rights reserved.                                                      *</span>
<a name="l00014"></a>00014 <span class="comment">*                                                                           *</span>
<a name="l00015"></a>00015 <span class="comment">* This program is free software; you can redistribute it and/or modify      *</span>
<a name="l00016"></a>00016 <span class="comment">* it under the terms of the GNU General Public License as published by      *</span>
<a name="l00017"></a>00017 <span class="comment">* the Free Software Foundation; either version 2 of the License, or         *</span>
<a name="l00018"></a>00018 <span class="comment">* (at your option) any later version.                                       *</span>
<a name="l00019"></a>00019 <span class="comment">*                                                                           *</span>
<a name="l00020"></a>00020 <span class="comment">* This program is distributed in the hope that it will be useful,           *</span>
<a name="l00021"></a>00021 <span class="comment">* but WITHOUT ANY WARRANTY; without even the implied warranty of            *</span>
<a name="l00022"></a>00022 <span class="comment">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the             *</span>
<a name="l00023"></a>00023 <span class="comment">* GNU General Public License (http://www.gnu.org/licenses/gpl.txt)          *</span>
<a name="l00024"></a>00024 <span class="comment">* for more details.                                                         *</span>
<a name="l00025"></a>00025 <span class="comment">*                                                                           *</span>
<a name="l00026"></a>00026 <span class="comment">****************************************************************************/</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/dc3/tin_8h.html">tin.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 
<a name="l00034"></a>00034 <span class="comment">//                                                              //</span>
<a name="l00035"></a>00035 <span class="comment">//    C L A S S   C O N S T R U C T O R S                       //</span>
<a name="l00036"></a>00036 <span class="comment">//                                                              //</span>
<a name="l00038"></a>00038 <span class="comment"></span>
<a name="l00039"></a>00039 
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca">00042</a> <a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca" title="Empty triangulation. Should be used only prior to a call to load().">Triangulation::Triangulation</a>()
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044  <a class="code" href="../../dc/d42/classTriangulation.html#a98cfd7aaa3a8bb5a9b13c43895604ab2" title="Number of boundary loops.">n_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a9610b511e11ad1a44f9b84441f16c165" title="Number of handles.">n_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a7c028d3bf49ef217cc6630099fd41fae" title="Number of connected components.">n_shells</a> = 0;
<a name="l00045"></a>00045  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 0;
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="../../dc/d42/classTriangulation.html#a4816fe17b710cdadb29987e2d9e0659d">00051</a> <a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca" title="Empty triangulation. Should be used only prior to a call to load().">Triangulation::Triangulation</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *tin_definition)
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053  <span class="keywordflow">if</span> (!strcmp(tin_definition, <span class="stringliteral">&quot;tetrahedron&quot;</span>))
<a name="l00054"></a>00054  {
<a name="l00055"></a>00055   <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1 = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(-1,-1.4142136,0);
<a name="l00056"></a>00056   <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v2 = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(-1,1.4142136,0);
<a name="l00057"></a>00057   <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v3 = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(1,0,-1.4142136);
<a name="l00058"></a>00058   <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v4 = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(1,0,1.4142136);
<a name="l00059"></a>00059   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e1 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v1,v2); v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e1;
<a name="l00060"></a>00060   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e2 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v2,v3); v2-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e2;
<a name="l00061"></a>00061   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e3 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v3,v1); v3-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e3;
<a name="l00062"></a>00062   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e4 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v1,v4); v4-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e4;
<a name="l00063"></a>00063   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e5 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v2,v4);
<a name="l00064"></a>00064   <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>   *e6 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v3,v4);
<a name="l00065"></a>00065   <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t1 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e1,e2,e3);
<a name="l00066"></a>00066   <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t2 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e1,e4,e5);
<a name="l00067"></a>00067   <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t3 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e2,e5,e6);
<a name="l00068"></a>00068   <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t4 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e3,e6,e4);
<a name="l00069"></a>00069   e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t1; e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t2;
<a name="l00070"></a>00070   e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t1; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t3;
<a name="l00071"></a>00071   e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t1; e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t4;
<a name="l00072"></a>00072   e4-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t2; e4-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t4;
<a name="l00073"></a>00073   e5-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t3; e5-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t2;
<a name="l00074"></a>00074   e6-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t4; e6-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t3;
<a name="l00075"></a>00075   <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v1); <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v2); <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v3); <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v4);
<a name="l00076"></a>00076   <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t4);
<a name="l00077"></a>00077   <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e1); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e2); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e3);
<a name="l00078"></a>00078   <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e4); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e5); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e6);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <a class="code" href="../../dc/d42/classTriangulation.html#a98cfd7aaa3a8bb5a9b13c43895604ab2" title="Number of boundary loops.">n_boundaries</a> = 0;
<a name="l00081"></a>00081   <a class="code" href="../../dc/d42/classTriangulation.html#a9610b511e11ad1a44f9b84441f16c165" title="Number of handles.">n_handles</a> = 0;
<a name="l00082"></a>00082   <a class="code" href="../../dc/d42/classTriangulation.html#a7c028d3bf49ef217cc6630099fd41fae" title="Number of connected components.">n_shells</a> = 1;
<a name="l00083"></a>00083   <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 0;
<a name="l00084"></a>00084  }
<a name="l00085"></a>00085  <span class="keywordflow">else</span> <a class="code" href="../../d3/dab/classJMesh.html#a5cd94530c89520f54ba406a90f623cde">JMesh::error</a>(<span class="stringliteral">&quot;Unknown triangulation type &#39;%s&#39;\n&quot;</span>,tin_definition);
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="../../dc/d42/classTriangulation.html#ae49dd73a8dc9b499df74b5a987dbd3b7">00091</a> <a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca" title="Empty triangulation. Should be used only prior to a call to load().">Triangulation::Triangulation</a>(<span class="keyword">const</span> <a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> *tin, <span class="keyword">const</span> <span class="keywordtype">bool</span> clone_info)
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00094"></a>00094  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *nv;
<a name="l00095"></a>00095  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *ne;
<a name="l00096"></a>00096  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *nt;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098  <span class="keywordtype">int</span> i;
<a name="l00099"></a>00099  <span class="keywordtype">void</span> **t_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00100"></a>00100  i=0; <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>)), t, n) t_info[i++]=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>;
<a name="l00101"></a>00101  <span class="keywordtype">void</span> **e_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00102"></a>00102  i=0; <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>)), e, n) e_info[i++]=e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>;
<a name="l00103"></a>00103  <span class="keywordtype">void</span> **v_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00104"></a>00104  i=0; <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>)), v, n) v_info[i++]=v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>)), v, n)
<a name="l00107"></a>00107   {nv=<span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v); <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nv); v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = nv;}
<a name="l00108"></a>00108 
<a name="l00109"></a>00109  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>)), e, n)
<a name="l00110"></a>00110   {ne=<span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>, (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(ne); e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = ne;}
<a name="l00111"></a>00111 
<a name="l00112"></a>00112  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>)), t, n)
<a name="l00113"></a>00113   {nt=<span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nt); t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = nt;}
<a name="l00114"></a>00114 
<a name="l00115"></a>00115  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>)), v, n) {((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;e0 = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = NULL;}
<a name="l00116"></a>00116 
<a name="l00117"></a>00117  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>)), e, n)
<a name="l00118"></a>00118   {((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>)?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL); ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL); e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = NULL;}
<a name="l00119"></a>00119 
<a name="l00120"></a>00120  i=0; <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>)), t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>=t_info[i++];
<a name="l00121"></a>00121  i=0; <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>)), e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>=e_info[i++];
<a name="l00122"></a>00122  i=0; <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>)), v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>=v_info[i++];
<a name="l00123"></a>00123 
<a name="l00124"></a>00124  <span class="keywordflow">if</span> (clone_info)
<a name="l00125"></a>00125  {
<a name="l00126"></a>00126   i=0; <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>=t_info[i++];
<a name="l00127"></a>00127   i=0; <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>=e_info[i++];
<a name="l00128"></a>00128   i=0; <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>=v_info[i++];  
<a name="l00129"></a>00129  }
<a name="l00130"></a>00130  <span class="keyword">delete</span> [] t_info; <span class="keyword">delete</span> [] e_info; <span class="keyword">delete</span> [] v_info;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="../../dc/d42/classTriangulation.html#a607737a00642fa9a2485b01b314ddf24">00140</a> <a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca" title="Empty triangulation. Should be used only prior to a call to load().">Triangulation::Triangulation</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0, <span class="keyword">const</span> <span class="keywordtype">bool</span> keep_reference)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo(t0), st, sv, se;
<a name="l00143"></a>00143  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00144"></a>00144  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *nt;
<a name="l00145"></a>00145  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *nv;
<a name="l00146"></a>00146  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *ne;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148  <span class="keywordflow">while</span> (todo.numels())
<a name="l00149"></a>00149  {
<a name="l00150"></a>00150   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.popHead();
<a name="l00151"></a>00151   st.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00152"></a>00152   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(nt); todo.appendHead(nt);}
<a name="l00153"></a>00153   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(nt); todo.appendHead(nt);}
<a name="l00154"></a>00154   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(nt); todo.appendHead(nt);}
<a name="l00155"></a>00155  }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;st), t, n)
<a name="l00158"></a>00158  {
<a name="l00159"></a>00159   <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00160"></a>00160   e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>; <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(e)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(e); se.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);}
<a name="l00161"></a>00161   e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>; <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(e)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(e); se.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);}
<a name="l00162"></a>00162   e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>; <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(e)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(e); se.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);}
<a name="l00163"></a>00163   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l00164"></a>00164   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l00165"></a>00165   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l00166"></a>00166  }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sv), v, n)
<a name="l00169"></a>00169   {<a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(v); nv=<span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v); <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nv); v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = nv;}
<a name="l00170"></a>00170 
<a name="l00171"></a>00171  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;se), e, n)
<a name="l00172"></a>00172   {<a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(e); ne=<span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>, (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>); <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(ne); e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = ne;}
<a name="l00173"></a>00173 
<a name="l00174"></a>00174  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;st), t, n)
<a name="l00175"></a>00175   {nt=<span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nt); t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = nt;}
<a name="l00176"></a>00176 
<a name="l00177"></a>00177  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sv), v, n) ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;e0 = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;se), e, n)
<a name="l00180"></a>00180   {((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>)?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL); ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL);}
<a name="l00181"></a>00181 
<a name="l00182"></a>00182  <span class="keywordflow">if</span> (!keep_reference)
<a name="l00183"></a>00183  {
<a name="l00184"></a>00184   <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sv), v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = NULL;
<a name="l00185"></a>00185   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;se), e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = NULL;
<a name="l00186"></a>00186   <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;st), t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = NULL;
<a name="l00187"></a>00187  }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189  <a class="code" href="../../dc/d42/classTriangulation.html#ab9694f134bbc51c81b8dfe675fa8ecd4" title="Updates the values of n_boundaries, n_handles and n_shells. O(N).">eulerUpdate</a>();
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="../../dc/d42/classTriangulation.html#a2f1d6b190514fd4dafa3eebd21bc3106">00195</a> <a class="code" href="../../dc/d42/classTriangulation.html#a2f1d6b190514fd4dafa3eebd21bc3106">Triangulation::~Triangulation</a>()
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#ab8a4169727166626a7a74e42f82f5d77" title="Deletes and removes all the nodes and frees data memory.   O(numels()).">freeNodes</a>();
<a name="l00198"></a>00198  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#ab8a4169727166626a7a74e42f82f5d77" title="Deletes and removes all the nodes and frees data memory.   O(numels()).">freeNodes</a>();
<a name="l00199"></a>00199  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#ab8a4169727166626a7a74e42f82f5d77" title="Deletes and removes all the nodes and frees data memory.   O(numels()).">freeNodes</a>();
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00204"></a>00204 <span class="comment">//                                                              //</span>
<a name="l00205"></a>00205 <span class="comment">//    P R I M I T I V E   C O N S T R U C T I O N               //</span>
<a name="l00206"></a>00206 <span class="comment">//                                                              //</span>
<a name="l00208"></a>00208 <span class="comment"></span>
<a name="l00209"></a>00209 
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f">00212</a> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *<a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f" title="Creates an Edge connecting two existing mesh vertices.">Triangulation::CreateEdge</a>(<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1, <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v2)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00215"></a>00215  
<a name="l00216"></a>00216  <span class="keywordflow">if</span> ((e = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2)) != NULL) <span class="keywordflow">return</span> e;
<a name="l00217"></a>00217  
<a name="l00218"></a>00218  e = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v1,v2);
<a name="l00219"></a>00219  v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00220"></a>00220  v2-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00221"></a>00221  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223  <span class="keywordflow">return</span> e;
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="../../dc/d42/classTriangulation.html#aa3ca90390788c236da8f150c56b09f12">00229</a> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *<a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f" title="Creates an Edge connecting two existing mesh vertices.">Triangulation::CreateEdge</a>(<a class="code" href="../../d2/d49/classExtVertex.html" title="Extended vertex for temporary use during connectivity creation.">ExtVertex</a> *v1, <a class="code" href="../../d2/d49/classExtVertex.html" title="Extended vertex for temporary use during connectivity creation.">ExtVertex</a> *v2, <span class="keyword">const</span> <span class="keywordtype">bool</span> check)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00232"></a>00232  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234  <span class="keywordflow">if</span> (check)
<a name="l00235"></a>00235   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a710e115afd39fe7429185559d1222359">VE</a>)), e, n)
<a name="l00236"></a>00236    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>) == v2-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>) <span class="keywordflow">return</span> e;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238  e = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>,v2-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>);
<a name="l00239"></a>00239  <span class="keywordflow">if</span> (v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> == NULL) v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00240"></a>00240  <span class="keywordflow">if</span> (v2-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> == NULL) v2-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a4b8ec7b52e2cb5390b29f2f6254c2823">v</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00241"></a>00241  v1-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a710e115afd39fe7429185559d1222359">VE</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l00242"></a>00242  v2-&gt;<a class="code" href="../../d2/d49/classExtVertex.html#a710e115afd39fe7429185559d1222359">VE</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l00243"></a>00243  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l00244"></a>00244 
<a name="l00245"></a>00245  <span class="keywordflow">return</span> e;
<a name="l00246"></a>00246 }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a">00251</a> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *<a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">Triangulation::CreateTriangle</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e2, <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e3)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *tt, **at1, **at2, **at3;
<a name="l00254"></a>00254  
<a name="l00255"></a>00255  <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e2) == e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> &amp;&amp; e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at1 = &amp;(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00256"></a>00256  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e2) == e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> &amp;&amp; e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at1 = &amp;(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00257"></a>00257  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00258"></a>00258  <span class="keywordflow">if</span> (e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e3) == e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at2 = &amp;(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00259"></a>00259  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e3) == e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at2 = &amp;(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00260"></a>00260  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00261"></a>00261  <span class="keywordflow">if</span> (e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e1) == e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> &amp;&amp; e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at3 = &amp;(e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00262"></a>00262  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e1) == e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> &amp;&amp; e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at3 = &amp;(e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00263"></a>00263  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265  tt = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e1,e2,e3);
<a name="l00266"></a>00266  *at1 = *at2 = *at3 = tt;
<a name="l00267"></a>00267  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(tt);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271  <span class="keywordflow">return</span> tt;
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="../../dc/d42/classTriangulation.html#a1587ff99be0f56a04cc2c07b7e131de8">00277</a> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *<a class="code" href="../../dc/d42/classTriangulation.html#a1587ff99be0f56a04cc2c07b7e131de8" title="Creates an arbitrarily oriented Triangle bounded by three existing mesh edges.">Triangulation::CreateUnorientedTriangle</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e2, <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e3)
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *tt, **at1, **at2, **at3;
<a name="l00280"></a>00280  
<a name="l00281"></a>00281  <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at1 = &amp;(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00282"></a>00282  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at1 = &amp;(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00283"></a>00283  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00284"></a>00284  <span class="keywordflow">if</span> (e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at2 = &amp;(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00285"></a>00285  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at2 = &amp;(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00286"></a>00286  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00287"></a>00287  <span class="keywordflow">if</span> (e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL) at3 = &amp;(e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00288"></a>00288  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) at3 = &amp;(e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00289"></a>00289  <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291  tt = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(e1,e2,e3);
<a name="l00292"></a>00292  *at1 = *at2 = *at3 = tt;
<a name="l00293"></a>00293  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(tt);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295  <span class="keywordflow">return</span> tt;
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="../../dc/d42/classTriangulation.html#ae6106620e0853f98aded0112640dea4d">00301</a> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *<a class="code" href="../../dc/d42/classTriangulation.html#ae6106620e0853f98aded0112640dea4d" title="Creates a new Edge &#39;e&#39; and an oriented Triangle bounded by &#39;e&#39;, &#39;e1&#39; and &#39;e2&#39;.">Triangulation::EulerEdgeTriangle</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e2, <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e3)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *cv = e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e3);
<a name="l00304"></a>00304  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *adj = (e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL)?(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>):(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00305"></a>00305  <span class="keywordflow">if</span> (cv == NULL || !e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() || !e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) <span class="keywordflow">return</span> NULL;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1 = <a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f" title="Creates an Edge connecting two existing mesh vertices.">CreateEdge</a>(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(cv), e3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(cv));
<a name="l00308"></a>00308  <span class="keywordflow">if</span> (adj-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e2)-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a63613c87061cd892d2cb135651b8f492" title="TRUE iff &#39;v&#39; is an end-point of the edge.">hasVertex</a>(cv)) <span class="keywordflow">return</span> <a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">CreateTriangle</a>(e1,e3,e2);
<a name="l00309"></a>00309  <span class="keywordflow">return</span> <a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">CreateTriangle</a>(e1,e2,e3);
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00314"></a>00314 <span class="comment">//                                                              //</span>
<a name="l00315"></a>00315 <span class="comment">//    P R I M I T I V E   D E S T R U C T I O N                 //</span>
<a name="l00316"></a>00316 <span class="comment">//                                                              //</span>
<a name="l00318"></a>00318 <span class="comment"></span>
<a name="l00319"></a>00319 
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012">00322</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">Triangulation::unlinkTriangle</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(), *v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(), *v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00325"></a>00325  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, *e2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, *e3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327  <span class="keywordtype">int</span> v1nm = (v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#a48bf625b550d53b26111b2cd12d4ebc3" title="TRUE iff vertex is on boundary.">isOnBoundary</a>() &amp;&amp; !e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; !e2-&gt;isOnBoundary());
<a name="l00328"></a>00328  <span class="keywordtype">int</span> v2nm = (v2-&gt;isOnBoundary() &amp;&amp; !e2-&gt;isOnBoundary() &amp;&amp; !e3-&gt;isOnBoundary());
<a name="l00329"></a>00329  <span class="keywordtype">int</span> v3nm = (v3-&gt;isOnBoundary() &amp;&amp; !e3-&gt;isOnBoundary() &amp;&amp; !e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>());
<a name="l00330"></a>00330 
<a name="l00331"></a>00331  v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = ((e2-&gt;isOnBoundary())?(e1):(e2));
<a name="l00332"></a>00332  v2-&gt;e0 = ((e3-&gt;isOnBoundary())?(e2):(e3));
<a name="l00333"></a>00333  v3-&gt;e0 = ((e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>())?(e3):(e1));
<a name="l00334"></a>00334 
<a name="l00335"></a>00335  e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(t, NULL);
<a name="l00336"></a>00336  e2-&gt;replaceTriangle(t, NULL);
<a name="l00337"></a>00337  e3-&gt;replaceTriangle(t, NULL);
<a name="l00338"></a>00338 
<a name="l00339"></a>00339  <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#afc8133018bd98eaf049783f5c0eeb93d" title="TRUE iff edge is isolated (i.e., both the two incident triangles are NULL).">isIsolated</a>() &amp;&amp; e2-&gt;isIsolated()) v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00340"></a>00340  if (e2-&gt;isIsolated() &amp;&amp; e3-&gt;isIsolated()) v2-&gt;e0 = NULL;
<a name="l00341"></a>00341  if (e3-&gt;isIsolated() &amp;&amp; e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#afc8133018bd98eaf049783f5c0eeb93d" title="TRUE iff edge is isolated (i.e., both the two incident triangles are NULL).">isIsolated</a>()) v3-&gt;e0 = NULL;
<a name="l00342"></a>00342  if (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#afc8133018bd98eaf049783f5c0eeb93d" title="TRUE iff edge is isolated (i.e., both the two incident triangles are NULL).">isIsolated</a>()) e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = NULL;
<a name="l00343"></a>00343  if (e2-&gt;isIsolated()) e2-&gt;v1 = e2-&gt;v2 = NULL;
<a name="l00344"></a>00344  if (e3-&gt;isIsolated()) e3-&gt;v1 = e3-&gt;v2 = NULL;
<a name="l00345"></a>00345  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> = NULL;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *nv;
<a name="l00348"></a>00348  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00349"></a>00349  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve;
<a name="l00350"></a>00350  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352  if (v1nm)
<a name="l00353"></a>00353  {
<a name="l00354"></a>00354   nv = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v1-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>, v1-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>, v1-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>);
<a name="l00355"></a>00355   nv-&gt;e0 = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>;
<a name="l00356"></a>00356   ve = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00357"></a>00357   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, n) e-&gt;replaceVertex(v1, nv);
<a name="l00358"></a>00358   <span class="keyword">delete</span>(ve);
<a name="l00359"></a>00359   v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e1;
<a name="l00360"></a>00360   <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nv);
<a name="l00361"></a>00361  }
<a name="l00362"></a>00362  <span class="keywordflow">if</span> (v2nm)
<a name="l00363"></a>00363  {
<a name="l00364"></a>00364   nv = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v2-&gt;x, v2-&gt;y, v2-&gt;z);
<a name="l00365"></a>00365   nv-&gt;e0 = v2-&gt;e0;
<a name="l00366"></a>00366   ve = v2-&gt;VE();
<a name="l00367"></a>00367   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, n) e-&gt;replaceVertex(v2, nv);
<a name="l00368"></a>00368   <span class="keyword">delete</span>(ve);
<a name="l00369"></a>00369   v2-&gt;e0 = e2;
<a name="l00370"></a>00370   <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nv);
<a name="l00371"></a>00371  }
<a name="l00372"></a>00372  <span class="keywordflow">if</span> (v3nm)
<a name="l00373"></a>00373  {
<a name="l00374"></a>00374   nv = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v3-&gt;x, v3-&gt;y, v3-&gt;z);
<a name="l00375"></a>00375   nv-&gt;e0 = v3-&gt;e0;
<a name="l00376"></a>00376   ve = v3-&gt;VE();
<a name="l00377"></a>00377   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, n) e-&gt;replaceVertex(v3, nv);
<a name="l00378"></a>00378   <span class="keyword">delete</span>(ve);
<a name="l00379"></a>00379   v3-&gt;e0 = e3;
<a name="l00380"></a>00380   <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nv);
<a name="l00381"></a>00381  }
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="../../dc/d42/classTriangulation.html#a8f482a51bb802c2eabc45310016e2fe3">00388</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a8f482a51bb802c2eabc45310016e2fe3" title="Unlinks a triangle from the mesh. O(1).">Triangulation::unlinkTriangleNoManifold</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, *e2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, *e3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392  e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(t, NULL);
<a name="l00393"></a>00393  e2-&gt;replaceTriangle(t, NULL);
<a name="l00394"></a>00394  e3-&gt;replaceTriangle(t, NULL);
<a name="l00395"></a>00395 
<a name="l00396"></a>00396  <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#afc8133018bd98eaf049783f5c0eeb93d" title="TRUE iff edge is isolated (i.e., both the two incident triangles are NULL).">isIsolated</a>()) e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = NULL;
<a name="l00397"></a>00397  if (e2-&gt;isIsolated()) e2-&gt;v1 = e2-&gt;v2 = NULL;
<a name="l00398"></a>00398  if (e3-&gt;isIsolated()) e3-&gt;v1 = e3-&gt;v2 = NULL;
<a name="l00399"></a>00399  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> = NULL;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="../../dc/d42/classTriangulation.html#aeedefd413ed4bf00beb971cc7f7a29af">00405</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#aeedefd413ed4bf00beb971cc7f7a29af" title="Removes all the unlinked triangles from List T. Returns the number of removed triangles. O(N).">Triangulation::removeTriangles</a>()
<a name="l00406"></a>00406 {
<a name="l00407"></a>00407  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00408"></a>00408  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00409"></a>00409  <span class="keywordtype">int</span> r = 0;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411  n = <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>();
<a name="l00412"></a>00412  <span class="keywordflow">do</span>
<a name="l00413"></a>00413  {
<a name="l00414"></a>00414   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00415"></a>00415   n = n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l00416"></a>00416   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> == NULL)
<a name="l00417"></a>00417   {
<a name="l00418"></a>00418    r++;
<a name="l00419"></a>00419    <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>((n!=NULL)?(n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()):<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>());
<a name="l00420"></a>00420    <span class="keyword">delete</span> t;
<a name="l00421"></a>00421   }
<a name="l00422"></a>00422  } <span class="keywordflow">while</span> (n != NULL);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426  <span class="keywordflow">return</span> r;
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 
<a name="l00431"></a>00431 
<a name="l00432"></a><a class="code" href="../../dc/d42/classTriangulation.html#ad8bdc6989d15950a95ad6a7dd217a0aa">00432</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#ad8bdc6989d15950a95ad6a7dd217a0aa" title="Removes all the unlinked edges from List E. Returns the number of removed edges. O(N).">Triangulation::removeEdges</a>()
<a name="l00433"></a>00433 {
<a name="l00434"></a>00434  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00435"></a>00435  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00436"></a>00436  <span class="keywordtype">int</span> r = 0;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438  n = <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>();
<a name="l00439"></a>00439  <span class="keywordflow">do</span>
<a name="l00440"></a>00440  {
<a name="l00441"></a>00441   e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00442"></a>00442   n = n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l00443"></a>00443   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> == NULL || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> == NULL)
<a name="l00444"></a>00444   {
<a name="l00445"></a>00445    r++;
<a name="l00446"></a>00446    <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>((n!=NULL)?(n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()):<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>());
<a name="l00447"></a>00447    <span class="keyword">delete</span> e;
<a name="l00448"></a>00448   }
<a name="l00449"></a>00449  } <span class="keywordflow">while</span> (n != NULL);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453  <span class="keywordflow">return</span> r;
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 
<a name="l00458"></a>00458 
<a name="l00459"></a><a class="code" href="../../dc/d42/classTriangulation.html#a88faaa85a54d3999157d13b2775a1a8e">00459</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a88faaa85a54d3999157d13b2775a1a8e" title="Removes all the unlinked vertices from List V. Returns the number of removed vertices. O(N).">Triangulation::removeVertices</a>()
<a name="l00460"></a>00460 {
<a name="l00461"></a>00461  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00462"></a>00462  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l00463"></a>00463  <span class="keywordtype">int</span> r = 0;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465  n = <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>();
<a name="l00466"></a>00466  <span class="keywordflow">do</span>
<a name="l00467"></a>00467  {
<a name="l00468"></a>00468   v = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00469"></a>00469   n = n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l00470"></a>00470   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> == NULL)
<a name="l00471"></a>00471   {
<a name="l00472"></a>00472    r++;
<a name="l00473"></a>00473    <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>((n!=NULL)?(n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()):<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>());
<a name="l00474"></a>00474    <span class="keyword">delete</span> v;
<a name="l00475"></a>00475   }
<a name="l00476"></a>00476  } <span class="keywordflow">while</span> (n != NULL);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480  <span class="keywordflow">return</span> r;
<a name="l00481"></a>00481 }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 
<a name="l00486"></a>00486 <span class="comment">//                                                              //</span>
<a name="l00487"></a>00487 <span class="comment">//    S E L E C T I O N   M A N A G E M E N T                   //</span>
<a name="l00488"></a>00488 <span class="comment">//                                                              //</span>
<a name="l00490"></a>00490 <span class="comment"></span>
<a name="l00491"></a>00491 
<a name="l00493"></a>00493 
<a name="l00494"></a><a class="code" href="../../dc/d42/classTriangulation.html#a9d805022386068e20c98f2294fd09e3d">00494</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a9d805022386068e20c98f2294fd09e3d" title="Deselects all the triangles. O(N).">Triangulation::deselectTriangles</a>()
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00497"></a>00497  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00498"></a>00498  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t);
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="../../dc/d42/classTriangulation.html#a30ec8e3bdb03c46861ff625eead3a002">00504</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a30ec8e3bdb03c46861ff625eead3a002" title="Removes all the selected triangles. O(N).">Triangulation::removeSelectedTriangles</a>()
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00507"></a>00507  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t)) <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(t);
<a name="l00510"></a>00510  <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">// Mark all the triangles having at least one boundary vertex as &#39;selected&#39;</span>
<a name="l00515"></a>00515 
<a name="l00516"></a><a class="code" href="../../dc/d42/classTriangulation.html#a3ea0eb002bb4335b2dc4b636a53e49b5">00516</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a3ea0eb002bb4335b2dc4b636a53e49b5">Triangulation::selectBoundaryTriangles</a>()
<a name="l00517"></a>00517 {
<a name="l00518"></a>00518  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00519"></a>00519  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00520"></a>00520  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *v1, *v2, *v3;
<a name="l00521"></a>00521  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00522"></a>00522  <span class="keywordtype">int</span> ns=0;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>);}
<a name="l00525"></a>00525 
<a name="l00526"></a>00526  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00527"></a>00527  {
<a name="l00528"></a>00528   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00529"></a>00529   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v1) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v2) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v3)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t); ns++;}
<a name="l00530"></a>00530  }
<a name="l00531"></a>00531  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l00532"></a>00532 
<a name="l00533"></a>00533  <span class="keywordflow">return</span> ns;
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">// Grows the current selection (1 triangle width)</span>
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="../../dc/d42/classTriangulation.html#af715797065c998891527a4b614e56ce0">00539</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#af715797065c998891527a4b614e56ce0" title="Enlarges the current selection of one triangle in width. O(N).">Triangulation::growSelection</a>()
<a name="l00540"></a>00540 {
<a name="l00541"></a>00541  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00542"></a>00542  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *v1, *v2, *v3;
<a name="l00543"></a>00543  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00544"></a>00544  <span class="keywordtype">int</span> ns=0;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00547"></a>00547  {
<a name="l00548"></a>00548   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00549"></a>00549   <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v1); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v2); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v3);
<a name="l00550"></a>00550  }
<a name="l00551"></a>00551  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00552"></a>00552  {
<a name="l00553"></a>00553   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00554"></a>00554   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v1) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v2) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v3)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t); ns++;}
<a name="l00555"></a>00555  }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l00558"></a>00558 
<a name="l00559"></a>00559  <span class="keywordflow">return</span> ns;
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 
<a name="l00563"></a>00563 <span class="comment">// Shrinks the current selection (1 triangle width)</span>
<a name="l00564"></a>00564 
<a name="l00565"></a><a class="code" href="../../dc/d42/classTriangulation.html#a2d4a4c4990cc6c1ecfdcc1f9bab5d300">00565</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a2d4a4c4990cc6c1ecfdcc1f9bab5d300" title="Shrinks the current selection of one triangle in width. O(N).">Triangulation::shrinkSelection</a>()
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00568"></a>00568  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *v1, *v2, *v3;
<a name="l00569"></a>00569  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00572"></a>00572  {
<a name="l00573"></a>00573   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00574"></a>00574   <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v1); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v2); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v3);
<a name="l00575"></a>00575  }
<a name="l00576"></a>00576  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00577"></a>00577  {
<a name="l00578"></a>00578   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l00579"></a>00579   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v1) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v2) || <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v3)) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t);
<a name="l00580"></a>00580  }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l00583"></a>00583 }
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="comment">// Toggles the selection status of the triangles</span>
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="../../dc/d42/classTriangulation.html#a12d7b202b70c8ddba10f5d78a1428ceb">00588</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a12d7b202b70c8ddba10f5d78a1428ceb" title="Inverts the selection status of all the triangles. O(N).">Triangulation::invertSelection</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l00589"></a>00589 {
<a name="l00590"></a>00590  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00591"></a>00591  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593  <span class="keywordflow">if</span> (t0 != NULL)
<a name="l00594"></a>00594  {
<a name="l00595"></a>00595   <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> totoggle(t0);
<a name="l00596"></a>00596   <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l00597"></a>00597   <span class="keywordtype">bool</span> unmark = <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t0);
<a name="l00598"></a>00598   <span class="keywordflow">if</span> (unmark) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t0); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t0);
<a name="l00599"></a>00599   <span class="keywordflow">while</span> ((t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)totoggle.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>()) != NULL)
<a name="l00600"></a>00600   {
<a name="l00601"></a>00601    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; ((<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; unmark) || (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; !unmark)))
<a name="l00602"></a>00602     {<span class="keywordflow">if</span> (unmark) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(s); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s); totoggle.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s);}
<a name="l00603"></a>00603    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; ((<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; unmark) || (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; !unmark)))
<a name="l00604"></a>00604     {<span class="keywordflow">if</span> (unmark) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(s); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s); totoggle.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s);}
<a name="l00605"></a>00605    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; ((<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; unmark) || (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; !unmark)))
<a name="l00606"></a>00606     {<span class="keywordflow">if</span> (unmark) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(s); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s); totoggle.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s);}
<a name="l00607"></a>00607   }
<a name="l00608"></a>00608  }
<a name="l00609"></a>00609  <span class="keywordflow">else</span>
<a name="l00610"></a>00610  {
<a name="l00611"></a>00611   <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t)) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t);
<a name="l00612"></a>00612  }
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 
<a name="l00616"></a><a class="code" href="../../dc/d42/classTriangulation.html#a371f93b6dee4058d7c126313339f011e">00616</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a371f93b6dee4058d7c126313339f011e" title="If &#39;t0&#39; is selected, deselect everything but the selected triangles connected to &#39;t0&#39;.">Triangulation::reselectSelection</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618  <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t0)) <span class="keywordflow">return</span>;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00621"></a>00621  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *s;
<a name="l00622"></a>00622  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList(t0);
<a name="l00623"></a>00623  <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t0);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625  <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00626"></a>00626  {
<a name="l00627"></a>00627   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00628"></a>00628   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(s) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(s);}
<a name="l00629"></a>00629   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(s) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(s);}
<a name="l00630"></a>00630   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(s) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(s);}
<a name="l00631"></a>00631  }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t)) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00634"></a>00634 }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 <span class="comment">// Creates a new mesh out of a selection.</span>
<a name="l00637"></a>00637 
<a name="l00638"></a><a class="code" href="../../dc/d42/classTriangulation.html#a1b01a95f2a5f2339a7adb94613fbf6e1">00638</a> <a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> *<a class="code" href="../../dc/d42/classTriangulation.html#a1b01a95f2a5f2339a7adb94613fbf6e1" title="Creates a new Triangulation out of an existing selection containing &#39;t0&#39;. O(output).">Triangulation::createSubMeshFromSelection</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0, <span class="keywordtype">bool</span> keep_ref)
<a name="l00639"></a>00639 {
<a name="l00640"></a>00640  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t,*s, *nt;
<a name="l00641"></a>00641  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643  <span class="keywordflow">if</span> (t0 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t0)) <span class="keywordflow">return</span> NULL;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645  <a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> *tin = <span class="keyword">new</span> <a class="code" href="../../dc/d42/classTriangulation.html#a56118103ad86aa7b37d7a005892bfeca" title="Empty triangulation. Should be used only prior to a call to load().">Triangulation</a>;
<a name="l00646"></a>00646  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v,*nv;
<a name="l00647"></a>00647  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *ne;
<a name="l00648"></a>00648  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList, sT, sE, sV;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650  <span class="keywordflow">if</span> (t0 != NULL)
<a name="l00651"></a>00651  {
<a name="l00652"></a>00652   triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t0,3);
<a name="l00653"></a>00653   <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00654"></a>00654   {
<a name="l00655"></a>00655    t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00656"></a>00656    sT.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00657"></a>00657    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, 3)) {sE.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, 3);}
<a name="l00658"></a>00658    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, 3)) {sE.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, 3);}
<a name="l00659"></a>00659    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>, 3)) {sE.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>, 3);}
<a name="l00660"></a>00660    <span class="keywordflow">if</span> ((v=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>()) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v, 3)) {sV.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v, 3);}
<a name="l00661"></a>00661    <span class="keywordflow">if</span> ((v=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>()) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v, 3)) {sV.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v, 3);}
<a name="l00662"></a>00662    <span class="keywordflow">if</span> ((v=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>()) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v, 3)) {sV.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v, 3);}
<a name="l00663"></a>00663    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00664"></a>00664    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00665"></a>00665    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00666"></a>00666   }
<a name="l00667"></a>00667  }
<a name="l00668"></a>00668  <span class="keywordflow">else</span>
<a name="l00669"></a>00669  {
<a name="l00670"></a>00670   <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00671"></a>00671    {sT.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>, 3);}
<a name="l00672"></a>00672   <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(e,3))
<a name="l00673"></a>00673    {sE.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, 3);}
<a name="l00674"></a>00674   <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v,3)) sV.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l00675"></a>00675  }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679  <span class="keywordtype">int</span> i;
<a name="l00680"></a>00680  <span class="keywordtype">void</span> **v_info = NULL, **e_info = NULL, **t_info = NULL;
<a name="l00681"></a>00681  <span class="keywordflow">if</span> (!keep_ref)
<a name="l00682"></a>00682  {
<a name="l00683"></a>00683   v_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[sV.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00684"></a>00684   i=0; <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sV), v, n) v_info[i++] = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>;
<a name="l00685"></a>00685   e_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[sE.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00686"></a>00686   i=0; <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n) e_info[i++] = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>;
<a name="l00687"></a>00687   t_info = <span class="keyword">new</span> <span class="keywordtype">void</span> *[sT.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()];
<a name="l00688"></a>00688   i=0; <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;sT), t, n) t_info[i++] = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>;
<a name="l00689"></a>00689  }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sV), v, n)
<a name="l00692"></a>00692   {nv=<span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(v); tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nv); v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = nv;}
<a name="l00693"></a>00693 
<a name="l00694"></a>00694  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n)
<a name="l00695"></a>00695   {ne=<span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>, (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>); tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(ne); e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = ne;}
<a name="l00696"></a>00696 
<a name="l00697"></a>00697  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;sT), t, n)
<a name="l00698"></a>00698   {nt=<span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>,(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>); tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(nt); t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = nt; nt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = t;}
<a name="l00699"></a>00699 
<a name="l00700"></a>00700  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sV), v, n) ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;e0 = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n)
<a name="l00703"></a>00703  {
<a name="l00704"></a>00704   ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>))?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL);
<a name="l00705"></a>00705   ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a>)-&gt;t2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>))?((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>):(NULL);
<a name="l00706"></a>00706  }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708  i=0; <span class="keywordflow">if</span> (!keep_ref) <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sV), v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = v_info[i++];
<a name="l00709"></a>00709  i=0; <span class="keywordflow">if</span> (!keep_ref) <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a90c11160cb5193630507405cc3d21762" title="Further information.">info</a> = e_info[i++];
<a name="l00710"></a>00710  i=0; <span class="keywordflow">if</span> (!keep_ref) <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;sT), t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a> = t_info[i++];
<a name="l00711"></a>00711 
<a name="l00712"></a>00712  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;sT), t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t, 3);
<a name="l00713"></a>00713  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;sE), e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(e, 3);
<a name="l00714"></a>00714  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;sV), v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(v, 3);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716  <span class="keywordflow">if</span> (!sT.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) {<span class="keyword">delete</span>(tin); <span class="keywordflow">return</span> NULL;}
<a name="l00717"></a>00717 
<a name="l00718"></a>00718  tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a42e3d87b90251c958abe310830303ac5">duplicateNonManifoldVertices</a>();
<a name="l00719"></a>00719  tin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#ab9694f134bbc51c81b8dfe675fa8ecd4" title="Updates the values of n_boundaries, n_handles and n_shells. O(N).">eulerUpdate</a>();
<a name="l00720"></a>00720 
<a name="l00721"></a>00721  <span class="keywordflow">return</span> tin;
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 
<a name="l00726"></a>00726 
<a name="l00727"></a><a class="code" href="../../dc/d42/classTriangulation.html#a7a3755242ac31162d7f5e274b199a3e7">00727</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a7a3755242ac31162d7f5e274b199a3e7" title="Marks all the triangles within distance L from &#39;p&#39; as selected. O(output).">Triangulation::selectSphericalRegion</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <span class="keyword">const</span> <span class="keywordtype">double</span> L, <span class="keyword">const</span> <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *center)
<a name="l00728"></a>00728 {
<a name="l00729"></a>00729  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *reg = <a class="code" href="../../dc/d42/classTriangulation.html#a8233a27825be5772141a37cc74a53d32" title="Make a list of triangles within distance L from &#39;p&#39;. O(output).">getRegion</a>(t, L, center);
<a name="l00730"></a>00730  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00731"></a>00731  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l00732"></a>00732  <span class="keywordtype">int</span> nt=0;
<a name="l00733"></a>00733 
<a name="l00734"></a>00734  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s); nt++;}
<a name="l00735"></a>00735  <span class="keyword">delete</span>(reg);
<a name="l00736"></a>00736 
<a name="l00737"></a>00737  <span class="keywordflow">return</span> nt;
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="../../dc/d42/classTriangulation.html#a1e694879f694e198ea880220a23a861e">00743</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a1e694879f694e198ea880220a23a861e" title="Marks all the triangles within distance L from &#39;p&#39; as deselected. O(output).">Triangulation::deselectSphericalRegion</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <span class="keyword">const</span> <span class="keywordtype">double</span> L, <span class="keyword">const</span> <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *center)
<a name="l00744"></a>00744 {
<a name="l00745"></a>00745  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *reg = <a class="code" href="../../dc/d42/classTriangulation.html#a8233a27825be5772141a37cc74a53d32" title="Make a list of triangles within distance L from &#39;p&#39;. O(output).">getRegion</a>(t, L, center);
<a name="l00746"></a>00746  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00747"></a>00747  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l00748"></a>00748  <span class="keywordtype">int</span> nt=0;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n) {<a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(s); nt++;}
<a name="l00751"></a>00751  <span class="keyword">delete</span>(reg);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753  <span class="keywordflow">return</span> nt;
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756 
<a name="l00759"></a>00759 
<a name="l00760"></a><a class="code" href="../../dc/d42/classTriangulation.html#af66893e75432c67005891b7694198fef">00760</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#af66893e75432c67005891b7694198fef" title="Deselects all the triangles farther than L from &#39;p&#39;. O(N).">Triangulation::reselectSphericalRegion</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <span class="keyword">const</span> <span class="keywordtype">double</span> L, <span class="keyword">const</span> <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *center)
<a name="l00761"></a>00761 {
<a name="l00762"></a>00762  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *reg = <a class="code" href="../../dc/d42/classTriangulation.html#a8233a27825be5772141a37cc74a53d32" title="Make a list of triangles within distance L from &#39;p&#39;. O(output).">getRegion</a>(t, L, center);
<a name="l00763"></a>00763  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00764"></a>00764  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n) <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(s);
<a name="l00767"></a>00767  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(s, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(s)) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(s);
<a name="l00768"></a>00768  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n) <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(s);
<a name="l00769"></a>00769  <span class="keyword">delete</span>(reg);
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772 
<a name="l00774"></a>00774 
<a name="l00775"></a><a class="code" href="../../dc/d42/classTriangulation.html#a1de82634da47e41a2cd34a0b25dd999e">00775</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d42/classTriangulation.html#a1de82634da47e41a2cd34a0b25dd999e" title="Re-triangulates the currently selected region using a Delaunay-like approach. O(SlogS).">Triangulation::retriangulateSelectedRegion</a>()
<a name="l00776"></a>00776 {
<a name="l00777"></a>00777  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> ttbr;
<a name="l00778"></a>00778  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00779"></a>00779  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *u;
<a name="l00780"></a>00780  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> nor;
<a name="l00781"></a>00781  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(u, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(u))
<a name="l00782"></a>00782   {ttbr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(u); nor = nor+(u-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>()*u-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa74ed09360f28cdbf3aad374d97311e7" title="Area of the triangle (Heron&#39;s formula).">area</a>());}
<a name="l00783"></a>00783 
<a name="l00784"></a>00784  <span class="keywordflow">if</span> (ttbr.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &lt; 2)
<a name="l00785"></a>00785  {
<a name="l00786"></a>00786   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;retriangulateRegion: Nothing to retriangulate.\n&quot;</span>);
<a name="l00787"></a>00787   <span class="keywordflow">return</span> 0;
<a name="l00788"></a>00788  }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(ttbr)), u, n)
<a name="l00791"></a>00791   <span class="keywordflow">if</span> (u-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>()*nor &lt;= 0.0)
<a name="l00792"></a>00792   {
<a name="l00793"></a>00793    <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;retriangulateRegion: Too complex geometry. Can&#39;t retriangulate.\n&quot;</span>);
<a name="l00794"></a>00794    <span class="keywordflow">return</span> 0;
<a name="l00795"></a>00795   }
<a name="l00796"></a>00796 
<a name="l00797"></a>00797  <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d42/classTriangulation.html#a9a45bd3e358f02c9f1f13c435cdd9c57" title="TRUE iff the set of selected triangles in &#39;l&#39; is simply connected. O(l-&gt;numels()).">isSelectionSimple</a>(&amp;ttbr))
<a name="l00798"></a>00798  {
<a name="l00799"></a>00799   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;retriangulateRegion: Non-simple region. Can&#39;t retriangulate.\n&quot;</span>);
<a name="l00800"></a>00800   <span class="keywordflow">return</span> 0;
<a name="l00801"></a>00801  }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ms = <a class="code" href="../../dc/d42/classTriangulation.html#aeeb2dc24a7b9d3dda4af7337613fd64a" title="Retrieve internal vertices of a region. O(l-&gt;numels()).">getRegionInternalVertices</a>(&amp;ttbr);
<a name="l00804"></a>00804 
<a name="l00805"></a>00805  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(ttbr)), u, n) <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(u);
<a name="l00806"></a>00806  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)ms-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l00807"></a>00807  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *vl = ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)ms-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l00808"></a>00808  <a class="code" href="../../dc/d42/classTriangulation.html#a777e577009b7e36cb1eb2d764979f2c6">TriangulateHole</a>(e, vl);
<a name="l00809"></a>00809  <span class="keyword">delete</span>(vl);
<a name="l00810"></a>00810  <span class="keyword">delete</span>(ms);
<a name="l00811"></a>00811  <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l00812"></a>00812 
<a name="l00813"></a>00813  <span class="keywordflow">return</span> 1;
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 
<a name="l00818"></a>00818 
<a name="l00819"></a><a class="code" href="../../dc/d42/classTriangulation.html#a9a45bd3e358f02c9f1f13c435cdd9c57">00819</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d42/classTriangulation.html#a9a45bd3e358f02c9f1f13c435cdd9c57" title="TRUE iff the set of selected triangles in &#39;l&#39; is simply connected. O(l-&gt;numels()).">Triangulation::isSelectionSimple</a>(<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *s)
<a name="l00820"></a>00820 {
<a name="l00821"></a>00821  <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <span class="keywordflow">return</span> 0; <span class="comment">// Empty region is not simple</span>
<a name="l00822"></a>00822 
<a name="l00823"></a>00823  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00824"></a>00824  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *ta, *t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)s-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00825"></a>00825  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bdr, top(t);
<a name="l00826"></a>00826  <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t);
<a name="l00827"></a>00827  <span class="keywordtype">int</span> nv=0;
<a name="l00828"></a>00828 
<a name="l00829"></a>00829  <span class="keywordflow">while</span> (top.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00830"></a>00830  {
<a name="l00831"></a>00831   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)top.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00832"></a>00832   nv++;
<a name="l00833"></a>00833   ta=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); <span class="keywordflow">if</span> (ta &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(ta)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(ta); top.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ta);}
<a name="l00834"></a>00834   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ta == NULL) <span class="keywordflow">break</span>; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>);
<a name="l00835"></a>00835   ta=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); <span class="keywordflow">if</span> (ta &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(ta)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(ta); top.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ta);}
<a name="l00836"></a>00836   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ta == NULL) <span class="keywordflow">break</span>; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>);
<a name="l00837"></a>00837   ta=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>(); <span class="keywordflow">if</span> (ta &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(ta)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(ta); top.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ta);}
<a name="l00838"></a>00838   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ta == NULL) <span class="keywordflow">break</span>; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(ta)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>);
<a name="l00839"></a>00839  }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(s, t, n) <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00842"></a>00842  <span class="keywordflow">if</span> (top.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <span class="keywordflow">return</span> 0; <span class="comment">// Mesh-boundary in selection</span>
<a name="l00843"></a>00843  <span class="keywordflow">if</span> (nv != s-&gt;<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <span class="keywordflow">return</span> 0; <span class="comment">// Disconnected selection</span>
<a name="l00844"></a>00844 
<a name="l00845"></a>00845  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *f, *ge=NULL, *e0;
<a name="l00846"></a>00846  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve;
<a name="l00847"></a>00847  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(bdr)), e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(e);
<a name="l00848"></a>00848  <span class="keywordtype">int</span> nae;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850  nv = 0;
<a name="l00851"></a>00851  e = e0 = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)bdr.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00852"></a>00852  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854  <span class="keywordflow">do</span>
<a name="l00855"></a>00855  {
<a name="l00856"></a>00856   nv++;
<a name="l00857"></a>00857   v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(v);
<a name="l00858"></a>00858   ve = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00859"></a>00859   nae=0; <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, f, n) <span class="keywordflow">if</span> (f!=e &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(f)) {ge=f; nae++;}
<a name="l00860"></a>00860   <span class="keyword">delete</span>(ve);
<a name="l00861"></a>00861   <span class="keywordflow">if</span> (nae &gt; 1) <span class="keywordflow">break</span>;
<a name="l00862"></a>00862   e=ge;
<a name="l00863"></a>00863  } <span class="keywordflow">while</span> (e != e0);
<a name="l00864"></a>00864 
<a name="l00865"></a>00865  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(bdr)), e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(e);
<a name="l00866"></a>00866  <span class="keywordflow">if</span> (nv != bdr.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <span class="keywordflow">return</span> 0; <span class="comment">// Non-simple selection</span>
<a name="l00867"></a>00867 
<a name="l00868"></a>00868  <span class="keywordflow">return</span> 1;
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 
<a name="l00874"></a>00874 
<a name="l00875"></a><a class="code" href="../../dc/d42/classTriangulation.html#a4893301d2b799c5ba91a25f82891dfa2">00875</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a4893301d2b799c5ba91a25f82891dfa2" title="Unmarks all the elements but leaves the selection status of triangles as is. O(N).">Triangulation::unmarkEverythingButSelections</a>()
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l00878"></a>00878  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00879"></a>00879  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00880"></a>00880  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00881"></a>00881  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) v-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = 0;
<a name="l00882"></a>00882  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = 0;
<a name="l00883"></a>00883  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> &amp;= (<span class="keywordtype">unsigned</span> char)1;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 
<a name="l00888"></a>00888 
<a name="l00889"></a><a class="code" href="../../dc/d42/classTriangulation.html#aa3d0fc07d7eeb5ba08eb1878439e1043">00889</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#aa3d0fc07d7eeb5ba08eb1878439e1043" title="Selects all the triangles of the connected component containing t0. O(N).">Triangulation::selectConnectedComponent</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0, <span class="keywordtype">bool</span> sos)
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo;
<a name="l00892"></a>00892  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l00893"></a>00893  <span class="keywordtype">int</span> ns = 0;
<a name="l00894"></a>00894 
<a name="l00895"></a>00895  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0);
<a name="l00896"></a>00896  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00897"></a>00897  {
<a name="l00898"></a>00898   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00899"></a>00899   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00900"></a>00900   {
<a name="l00901"></a>00901    t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l00902"></a>00902 
<a name="l00903"></a>00903    <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t1) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);
<a name="l00904"></a>00904    <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t2) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);
<a name="l00905"></a>00905    <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t3) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);
<a name="l00906"></a>00906 
<a name="l00907"></a>00907    <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t); ns++;
<a name="l00908"></a>00908   }
<a name="l00909"></a>00909  }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911  <span class="keywordflow">return</span> ns;
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 
<a name="l00916"></a>00916 
<a name="l00917"></a><a class="code" href="../../dc/d42/classTriangulation.html#a29409dc91c9d42d070a65c90d4903a50">00917</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a29409dc91c9d42d070a65c90d4903a50" title="Deselects all the triangles of the connected component containing t0. O(N).">Triangulation::deselectConnectedComponent</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0, <span class="keywordtype">bool</span> sos)
<a name="l00918"></a>00918 {
<a name="l00919"></a>00919  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo;
<a name="l00920"></a>00920  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l00921"></a>00921  <span class="keywordtype">int</span> ns = 0;
<a name="l00922"></a>00922 
<a name="l00923"></a>00923  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0);
<a name="l00924"></a>00924  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00925"></a>00925  {
<a name="l00926"></a>00926   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00927"></a>00927   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t))
<a name="l00928"></a>00928   {
<a name="l00929"></a>00929    t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l00930"></a>00930 
<a name="l00931"></a>00931    <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t1) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);
<a name="l00932"></a>00932    <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t2) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);
<a name="l00933"></a>00933    <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t3) &amp;&amp; (!(sos &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)))) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);
<a name="l00934"></a>00934 
<a name="l00935"></a>00935    <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t); ns++;
<a name="l00936"></a>00936   }
<a name="l00937"></a>00937  }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939  <span class="keywordflow">return</span> ns;
<a name="l00940"></a>00940 }
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 
<a name="l00943"></a>00943 <span class="comment">// Append to the current mesh a copy of all the elements of &#39;src&#39;.</span>
<a name="l00944"></a>00944 <span class="comment">// The newly created elements form a new selection.</span>
<a name="l00945"></a>00945 
<a name="l00946"></a><a class="code" href="../../dc/d42/classTriangulation.html#ab58c3b4785880610d32da14ed04fe9b4">00946</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#aa365f6a94fd13b55da377503beaa3d29" title="Append another triangle mesh to the existing one.">Triangulation::append</a>(<a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> *src)
<a name="l00947"></a>00947 {
<a name="l00948"></a>00948  <a class="code" href="../../dc/d42/classTriangulation.html#a9d805022386068e20c98f2294fd09e3d" title="Deselects all the triangles. O(N).">deselectTriangles</a>();
<a name="l00949"></a>00949  <a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> cb(src);
<a name="l00950"></a>00950  cb.<a class="code" href="../../dc/d42/classTriangulation.html#a12d7b202b70c8ddba10f5d78a1428ceb" title="Inverts the selection status of all the triangles. O(N).">invertSelection</a>();
<a name="l00951"></a>00951  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a456141b43acb6a78a05f62fe4189a1c1" title="Appends a list &#39;l&#39; to the tail by linking the first node of &#39;l&#39; to the last one of this list...">joinTailList</a>(&amp;(cb.<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>));
<a name="l00952"></a>00952  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a456141b43acb6a78a05f62fe4189a1c1" title="Appends a list &#39;l&#39; to the tail by linking the first node of &#39;l&#39; to the last one of this list...">joinTailList</a>(&amp;(cb.<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>));
<a name="l00953"></a>00953  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a456141b43acb6a78a05f62fe4189a1c1" title="Appends a list &#39;l&#39; to the tail by linking the first node of &#39;l&#39; to the last one of this list...">joinTailList</a>(&amp;(cb.<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>));
<a name="l00954"></a>00954  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00955"></a>00955 }
<a name="l00956"></a>00956 
<a name="l00958"></a>00958 <span class="comment">//                                                              //</span>
<a name="l00959"></a>00959 <span class="comment">//    R E G I O N   M A N I P U L A T I O N                     //</span>
<a name="l00960"></a>00960 <span class="comment">//                                                              //</span>
<a name="l00962"></a>00962 <span class="comment"></span>
<a name="l00964"></a>00964 
<a name="l00965"></a><a class="code" href="../../dc/d42/classTriangulation.html#a8233a27825be5772141a37cc74a53d32">00965</a> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *<a class="code" href="../../dc/d42/classTriangulation.html#a8233a27825be5772141a37cc74a53d32" title="Make a list of triangles within distance L from &#39;p&#39;. O(output).">Triangulation::getRegion</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <span class="keyword">const</span> <span class="keywordtype">double</span> L, <span class="keyword">const</span> <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *center)
<a name="l00966"></a>00966 {
<a name="l00967"></a>00967  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList, *toRemove = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l00968"></a>00968  <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>()-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &gt; L) <span class="keywordflow">return</span> toRemove;
<a name="l00969"></a>00969  <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>()-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &gt; L) <span class="keywordflow">return</span> toRemove;
<a name="l00970"></a>00970  <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>()-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &gt; L) <span class="keywordflow">return</span> toRemove;
<a name="l00971"></a>00971 
<a name="l00972"></a>00972  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l00973"></a>00973  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00974"></a>00974 
<a name="l00975"></a>00975  triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00976"></a>00976  <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t,3);
<a name="l00977"></a>00977 
<a name="l00978"></a>00978  <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &gt; 0)
<a name="l00979"></a>00979  {
<a name="l00980"></a>00980   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00981"></a>00981   triList.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(triList.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>());
<a name="l00982"></a>00982   toRemove-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l00985"></a>00985    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00986"></a>00986   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l00987"></a>00987    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00988"></a>00988   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l00989"></a>00989    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l00990"></a>00990  }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(toRemove, s, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(s, 3);
<a name="l00993"></a>00993 
<a name="l00994"></a>00994  <span class="keywordflow">return</span> toRemove;
<a name="l00995"></a>00995 }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997 
<a name="l00999"></a>00999 
<a name="l01000"></a><a class="code" href="../../dc/d42/classTriangulation.html#a93257ef041530dfad1f65250c956fadc">01000</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a93257ef041530dfad1f65250c956fadc" title="Removes triangles within distance L from &#39;p&#39;. O(N).">Triangulation::removeRegion</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <span class="keyword">const</span> <span class="keywordtype">double</span> L, <span class="keyword">const</span> <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *center)
<a name="l01001"></a>01001 {
<a name="l01002"></a>01002  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList, toRemove;
<a name="l01003"></a>01003  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01004"></a>01004  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l01005"></a>01005 
<a name="l01006"></a>01006  triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01007"></a>01007  <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t);
<a name="l01008"></a>01008 
<a name="l01009"></a>01009  <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &gt; 0)
<a name="l01010"></a>01010  {
<a name="l01011"></a>01011   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l01012"></a>01012   triList.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(triList.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>());
<a name="l01013"></a>01013   toRemove.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01014"></a>01014 
<a name="l01015"></a>01015   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l01016"></a>01016    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s);}
<a name="l01017"></a>01017   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l01018"></a>01018    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s);}
<a name="l01019"></a>01019   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s) &amp;&amp; s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ae40abf7aec2f2f3ca282dbe57bd18dc6" title="Distance from &#39;b&#39;.">distance</a>(center) &lt;= L)
<a name="l01020"></a>01020    {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(s);}
<a name="l01021"></a>01021  }
<a name="l01022"></a>01022 
<a name="l01023"></a>01023  <span class="keywordflow">for</span> (n = toRemove.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>(); n != NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>())
<a name="l01024"></a>01024  {
<a name="l01025"></a>01025   s = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01026"></a>01026   <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(s);
<a name="l01027"></a>01027  }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029  <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 
<a name="l01034"></a>01034 
<a name="l01035"></a><a class="code" href="../../dc/d42/classTriangulation.html#ae6929b477d611367ddd790667c8ad4dd">01035</a> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *<a class="code" href="../../dc/d42/classTriangulation.html#ae6929b477d611367ddd790667c8ad4dd" title="Get the vertex next to &#39;v&#39; on the boundary of the region. O(1).">Triangulation::nextVertexOnRegionBoundary</a>(<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *sv)<span class="keyword"> const</span>
<a name="l01036"></a>01036 <span class="keyword"></span>{
<a name="l01037"></a>01037  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *lt, *rt;
<a name="l01038"></a>01038  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01039"></a>01039  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve = sv-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l01040"></a>01040  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, n)
<a name="l01043"></a>01043  {
<a name="l01044"></a>01044   lt = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a3b8ea712f0ab29932345dc3c0e75c012" title="Triangle on the left of the edge when looking from &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge...">leftTriangle</a>(sv);
<a name="l01045"></a>01045   rt = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9d96fdbb2f8c4b792b3c1a50a533165e" title="Triangle on the right of the edge when looking from &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge...">rightTriangle</a>(sv);
<a name="l01046"></a>01046   <span class="keywordflow">if</span> (lt != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(lt) &amp;&amp; (rt == NULL || !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(rt)))
<a name="l01047"></a>01047    {<span class="keyword">delete</span>(ve); <span class="keywordflow">return</span> e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(sv);}
<a name="l01048"></a>01048  }
<a name="l01049"></a>01049  <span class="keyword">delete</span>(ve);
<a name="l01050"></a>01050 
<a name="l01051"></a>01051  <span class="keywordflow">return</span> NULL;
<a name="l01052"></a>01052 }
<a name="l01053"></a>01053 
<a name="l01054"></a>01054 
<a name="l01057"></a>01057 
<a name="l01058"></a><a class="code" href="../../dc/d42/classTriangulation.html#aeeb2dc24a7b9d3dda4af7337613fd64a">01058</a> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *<a class="code" href="../../dc/d42/classTriangulation.html#aeeb2dc24a7b9d3dda4af7337613fd64a" title="Retrieve internal vertices of a region. O(l-&gt;numels()).">Triangulation::getRegionInternalVertices</a>(<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *reg)
<a name="l01059"></a>01059 {
<a name="l01060"></a>01060  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *iVertices = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l01061"></a>01061  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *outList = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l01062"></a>01062  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *bEdge = NULL;
<a name="l01063"></a>01063  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s, *t;
<a name="l01064"></a>01064  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01065"></a>01065  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1, *v2, *v3;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, t, n) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t, 3);}
<a name="l01068"></a>01068 
<a name="l01069"></a>01069  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, t, n)
<a name="l01070"></a>01070  {
<a name="l01071"></a>01071   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t,3))
<a name="l01072"></a>01072   {
<a name="l01073"></a>01073    <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t,3);
<a name="l01074"></a>01074    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {bEdge = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>; <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, 3);}
<a name="l01075"></a>01075    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {bEdge = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>; <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, 3);}
<a name="l01076"></a>01076    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(s)) {bEdge = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>; <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, 3);}
<a name="l01077"></a>01077   }
<a name="l01078"></a>01078  }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n)
<a name="l01081"></a>01081  {
<a name="l01082"></a>01082   v1 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l01083"></a>01083   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v1, 3)) {iVertices-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v1); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v1, 3);}
<a name="l01084"></a>01084   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v2, 3)) {iVertices-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v2); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v2, 3);}
<a name="l01085"></a>01085   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v3, 3)) {iVertices-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(v3, 3);}
<a name="l01086"></a>01086  }
<a name="l01087"></a>01087  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(reg, s, n)
<a name="l01088"></a>01088  {
<a name="l01089"></a>01089   v1 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = s-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l01090"></a>01090   <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(v1, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(v2, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(v3, 3); 
<a name="l01091"></a>01091  }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093  outList-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(iVertices);
<a name="l01094"></a>01094  outList-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(bEdge);
<a name="l01095"></a>01095 
<a name="l01096"></a>01096  <span class="keywordflow">return</span> outList;
<a name="l01097"></a>01097 }
<a name="l01098"></a>01098 
<a name="l01099"></a>01099 
<a name="l01100"></a>01100 <span class="comment">// Transforms only the shell indicated by &#39;t0&#39;</span>
<a name="l01101"></a>01101 
<a name="l01102"></a><a class="code" href="../../dc/d42/classTriangulation.html#a00601a13a837721206ee2333c4ef98fd">01102</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a00601a13a837721206ee2333c4ef98fd" title="Transform the vertices of the shell containing &#39;t0&#39; using the matrix m. O(S).">Triangulation::transformShell</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0, <span class="keyword">const</span> <a class="code" href="../../d8/d62/classMatrix4x4.html" title="Generic 4x4 matrix.">Matrix4x4</a>&amp; m)
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo(t0), st, sv;
<a name="l01105"></a>01105  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *nt;
<a name="l01106"></a>01106  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l01107"></a>01107  <span class="keywordtype">double</span> x, y, z, w;
<a name="l01108"></a>01108 
<a name="l01109"></a>01109  <span class="keywordflow">while</span> (todo.numels())
<a name="l01110"></a>01110  {
<a name="l01111"></a>01111   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.popHead();
<a name="l01112"></a>01112   st.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01113"></a>01113   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(nt); todo.appendHead(nt);}
<a name="l01114"></a>01114   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(nt); todo.appendHead(nt);}
<a name="l01115"></a>01115   nt=t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>(); <span class="keywordflow">if</span> (nt != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(nt)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(nt); todo.appendHead(nt);}
<a name="l01116"></a>01116  }
<a name="l01117"></a>01117 
<a name="l01118"></a>01118  <span class="keywordflow">while</span> (st.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01119"></a>01119  {
<a name="l01120"></a>01120   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)st.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01121"></a>01121   <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t);
<a name="l01122"></a>01122   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l01123"></a>01123   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l01124"></a>01124   v = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>(); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v); sv.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);}
<a name="l01125"></a>01125  }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127  <span class="keywordflow">while</span> (sv.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01128"></a>01128  {
<a name="l01129"></a>01129   v = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)sv.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01130"></a>01130   <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l01131"></a>01131   x = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][0],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][0],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][0]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][0];
<a name="l01132"></a>01132   y = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][1],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][1],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][1]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][1];
<a name="l01133"></a>01133   z = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][2],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][2],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][2]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][2];
<a name="l01134"></a>01134   w = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][3],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][3],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][3]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][3];
<a name="l01135"></a>01135   v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = x/w; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = y/w; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = z/w; 
<a name="l01136"></a>01136  }
<a name="l01137"></a>01137 }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139 
<a name="l01141"></a>01141 
<a name="l01142"></a><a class="code" href="../../dc/d42/classTriangulation.html#a7de461faf1807bd76e9333a9bdee1eeb">01142</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a7de461faf1807bd76e9333a9bdee1eeb" title="Remove all the triangles belonging to the shell containing &#39;t0&#39;. O(N).">Triangulation::removeShell</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l01143"></a>01143 {
<a name="l01144"></a>01144  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo(t0);
<a name="l01145"></a>01145  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l01146"></a>01146 
<a name="l01147"></a>01147  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01148"></a>01148  {
<a name="l01149"></a>01149   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01150"></a>01150   t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l01151"></a>01151 
<a name="l01152"></a>01152   <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t1)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t1); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);}
<a name="l01153"></a>01153   <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t2)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t2); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);}
<a name="l01154"></a>01154   <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t3)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t3); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);}
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(t);
<a name="l01157"></a>01157  }
<a name="l01158"></a>01158 
<a name="l01159"></a>01159  <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l01160"></a>01160 }
<a name="l01161"></a>01161 
<a name="l01162"></a>01162 
<a name="l01164"></a>01164 <span class="comment">//                                                              //</span>
<a name="l01165"></a>01165 <span class="comment">//    G L O B A L   O P E R A T I O N S                         //</span>
<a name="l01166"></a>01166 <span class="comment">//                                                              //</span>
<a name="l01168"></a>01168 <span class="comment"></span>
<a name="l01169"></a>01169 
<a name="l01171"></a>01171 
<a name="l01172"></a><a class="code" href="../../dc/d42/classTriangulation.html#a170fa0854c673a0a808d4629d8d416b6">01172</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a170fa0854c673a0a808d4629d8d416b6" title="Tag sharp edges based on threshold angle. O(N).">Triangulation::sharpEdgeTagging</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> ta)
<a name="l01173"></a>01173 {
<a name="l01174"></a>01174  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01175"></a>01175  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01176"></a>01176  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l01177"></a>01177   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab014cdac249b4e5b34dbbe2ca4a5c2e7" title="Angle between the normals of the two incident triangles.">curvature</a>() &gt; ta) <a class="code" href="../../d5/dc3/tin_8h.html#a9fb69a2e891e5ffe5014bbf0d7bcdc0d">TAG_SHARPEDGE</a>(e);
<a name="l01178"></a>01178   <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a9578df35b5926978c52bf88c75897800">UNTAG_SHARPEDGE</a>(e);
<a name="l01179"></a>01179 }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 
<a name="l01183"></a>01183 
<a name="l01184"></a><a class="code" href="../../dc/d42/classTriangulation.html#af82942f087840e0773a31ab38c4997ba">01184</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#af82942f087840e0773a31ab38c4997ba" title="Unmark all the elements. O(N).">Triangulation::unmarkEverything</a>()
<a name="l01185"></a>01185 {
<a name="l01186"></a>01186  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l01187"></a>01187  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01188"></a>01188  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01189"></a>01189  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01190"></a>01190  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) v-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = 0;
<a name="l01191"></a>01191  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = 0;
<a name="l01192"></a>01192  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> = 0;
<a name="l01193"></a>01193 }
<a name="l01194"></a>01194 
<a name="l01195"></a>01195 
<a name="l01197"></a>01197 
<a name="l01198"></a><a class="code" href="../../dc/d42/classTriangulation.html#a90fccc3b0de0daa344043ef2998d857b">01198</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/d42/classTriangulation.html#a90fccc3b0de0daa344043ef2998d857b" title="Bounding box longest edge. &#39;b&#39; and &#39;t&#39; are set as the longest diagonal end-points. O(N).">Triangulation::getBoundingBox</a>(<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>&amp; mp, <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>&amp; Mp)<span class="keyword"> const</span>
<a name="l01199"></a>01199 <span class="keyword"></span>{
<a name="l01200"></a>01200  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v; <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01201"></a>01201  Mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = -DBL_MAX, mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = DBL_MAX;
<a name="l01202"></a>01202  Mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = -DBL_MAX, mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = DBL_MAX;
<a name="l01203"></a>01203  Mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = -DBL_MAX, mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = DBL_MAX;
<a name="l01204"></a>01204  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n)
<a name="l01205"></a>01205  {
<a name="l01206"></a>01206   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> &lt; mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>) mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>;
<a name="l01207"></a>01207   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> &gt; Mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>) Mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>;
<a name="l01208"></a>01208   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> &lt; mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>) mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>;
<a name="l01209"></a>01209   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> &gt; Mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>) Mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>;
<a name="l01210"></a>01210   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> &lt; mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>) mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>;
<a name="l01211"></a>01211   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> &gt; Mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>) Mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>;
<a name="l01212"></a>01212  }
<a name="l01213"></a>01213 
<a name="l01214"></a>01214  <span class="keywordflow">return</span> <a class="code" href="../../d3/da2/j__mesh_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(Mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>-mp.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>,<a class="code" href="../../d3/da2/j__mesh_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(Mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>-mp.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>,Mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>-mp.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>));
<a name="l01215"></a>01215 }
<a name="l01216"></a>01216 
<a name="l01217"></a>01217 
<a name="l01219"></a>01219 
<a name="l01220"></a><a class="code" href="../../dc/d42/classTriangulation.html#a05c3964cb90559996d93566c263e86c5">01220</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/d42/classTriangulation.html#a05c3964cb90559996d93566c263e86c5" title="Approximate bounding ball radius. O(N).">Triangulation::getBoundingBallRadius</a>()<span class="keyword"> const</span>
<a name="l01221"></a>01221 <span class="keyword"></span>{
<a name="l01222"></a>01222  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v; <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01223"></a>01223  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> tc, mp, Mp;
<a name="l01224"></a>01224  <span class="keywordtype">double</span> tb, bsr = <a class="code" href="../../dc/d42/classTriangulation.html#a90fccc3b0de0daa344043ef2998d857b" title="Bounding box longest edge. &#39;b&#39; and &#39;t&#39; are set as the longest diagonal end-points. O(N).">getBoundingBox</a>(mp, Mp)/2;
<a name="l01225"></a>01225  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> bsc = (Mp+mp)/2;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n)
<a name="l01228"></a>01228   <span class="keywordflow">if</span> ((tb = ((*v)-bsc).length()) &gt; bsr)
<a name="l01229"></a>01229   {
<a name="l01230"></a>01230    tc = ((*v)-bsc); tc.<a class="code" href="../../dc/d4f/classPoint.html#aef2212b0f31228e803ecbf389bfe7302" title="Divides the vector by its length. If isNull() the application exits with an error.">normalize</a>();
<a name="l01231"></a>01231    tb = ((tb-bsr)/2);
<a name="l01232"></a>01232    bsc = bsc+(tc*tb);
<a name="l01233"></a>01233    bsr += tb;
<a name="l01234"></a>01234   }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236  <span class="keywordflow">return</span> bsr;
<a name="l01237"></a>01237 }
<a name="l01238"></a>01238 
<a name="l01239"></a>01239 
<a name="l01241"></a>01241 
<a name="l01242"></a><a class="code" href="../../dc/d42/classTriangulation.html#a6763262beed011f0633bb364adf586eb">01242</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/d42/classTriangulation.html#a6763262beed011f0633bb364adf586eb" title="Total area of the mesh. O(N).">Triangulation::area</a>()<span class="keyword"> const</span>
<a name="l01243"></a>01243 <span class="keyword"></span>{
<a name="l01244"></a>01244  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01245"></a>01245  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01246"></a>01246  <span class="keywordtype">double</span> a=0.0;
<a name="l01247"></a>01247  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) a += t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa74ed09360f28cdbf3aad374d97311e7" title="Area of the triangle (Heron&#39;s formula).">area</a>();
<a name="l01248"></a>01248 
<a name="l01249"></a>01249  <span class="keywordflow">return</span> a;
<a name="l01250"></a>01250 }
<a name="l01251"></a>01251 
<a name="l01252"></a>01252 
<a name="l01254"></a>01254 
<a name="l01255"></a><a class="code" href="../../dc/d42/classTriangulation.html#a22bac7d2e0dec5b8007f48bc221c4f10">01255</a> <span class="keywordtype">double</span> <a class="code" href="../../dc/d42/classTriangulation.html#a22bac7d2e0dec5b8007f48bc221c4f10" title="Total volume of the mesh assuming that boundaries() = 0. O(N).">Triangulation::volume</a>()<span class="keyword"> const</span>
<a name="l01256"></a>01256 <span class="keyword"></span>{
<a name="l01257"></a>01257  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01258"></a>01258  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01259"></a>01259  <span class="keywordtype">double</span> v=0.0;
<a name="l01260"></a>01260  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n)
<a name="l01261"></a>01261   v += (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a75ccdf1d5198ab4fadd20e37af746ec8" title="Return the triangle&#39;s barycenter.">getCenter</a>()*t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>())*t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa74ed09360f28cdbf3aad374d97311e7" title="Area of the triangle (Heron&#39;s formula).">area</a>();
<a name="l01262"></a>01262 
<a name="l01263"></a>01263  <span class="keywordflow">return</span> v/3;
<a name="l01264"></a>01264 }
<a name="l01265"></a>01265 
<a name="l01266"></a>01266 
<a name="l01269"></a>01269 
<a name="l01270"></a><a class="code" href="../../dc/d42/classTriangulation.html#aa641295fb6059236e1adbd71849a1819">01270</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#aa641295fb6059236e1adbd71849a1819" title="Scale the mesh to make it fit within a cube [0,0,0]-[s,s,s]. O(N).">Triangulation::normalize</a>(<span class="keywordtype">double</span> mc)
<a name="l01271"></a>01271 {
<a name="l01272"></a>01272  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l01273"></a>01273  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01274"></a>01274  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> mp, Mp;
<a name="l01275"></a>01275  <span class="keywordtype">double</span> mel = <a class="code" href="../../dc/d42/classTriangulation.html#a90fccc3b0de0daa344043ef2998d857b" title="Bounding box longest edge. &#39;b&#39; and &#39;t&#39; are set as the longest diagonal end-points. O(N).">getBoundingBox</a>(mp, Mp)/mc;
<a name="l01276"></a>01276  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a0dc0ae0f78b3e63fac59ee239396577a" title="Set the coordinates to (a,b,c).">setValue</a>(((*v)-mp)/mel);    <span class="comment">// Shift and normalize</span>
<a name="l01277"></a>01277 }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279 
<a name="l01281"></a>01281 
<a name="l01282"></a><a class="code" href="../../dc/d42/classTriangulation.html#a1d62434e8cb8f69ab917425b207d9d70">01282</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a1d62434e8cb8f69ab917425b207d9d70" title="Transform the mesh geometry using the transformation matrix m. O(N).">Triangulation::transform</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d62/classMatrix4x4.html" title="Generic 4x4 matrix.">Matrix4x4</a>&amp; m)
<a name="l01283"></a>01283 {
<a name="l01284"></a>01284  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01285"></a>01285  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l01286"></a>01286  <span class="keywordtype">double</span> x,y,z,w;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n)
<a name="l01289"></a>01289  {
<a name="l01290"></a>01290   x = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][0],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][0],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][0]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][0];
<a name="l01291"></a>01291   y = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][1],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][1],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][1]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][1];
<a name="l01292"></a>01292   z = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][2],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][2],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][2]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][2];
<a name="l01293"></a>01293   w = ((*v)*<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a>(m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[0][3],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[1][3],m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[2][3]))+m.<a class="code" href="../../d8/d62/classMatrix4x4.html#a2424eaa1bf339bae5637981b2f3df09d" title="Actual matrix coefficients.">matrix</a>[3][3];
<a name="l01294"></a>01294   v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = x/w; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = y/w; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = z/w; 
<a name="l01295"></a>01295  }
<a name="l01296"></a>01296 }
<a name="l01297"></a>01297 
<a name="l01298"></a>01298 
<a name="l01299"></a>01299 <span class="comment">// Add noise in the normal direction. Normal displacement is</span>
<a name="l01300"></a>01300 <span class="comment">// bounded by ns% of the bounding ball radius.</span>
<a name="l01301"></a>01301 
<a name="l01302"></a><a class="code" href="../../dc/d42/classTriangulation.html#a6f35f04d05674bf7f7913b09062e6d88">01302</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a6f35f04d05674bf7f7913b09062e6d88" title="Randomly move vertices along their normals. O(N).">Triangulation::addNormalNoise</a>(<span class="keywordtype">double</span> ns)
<a name="l01303"></a>01303 {
<a name="l01304"></a>01304  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l01305"></a>01305  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01306"></a>01306  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> np;
<a name="l01307"></a>01307  <span class="keywordtype">int</span> i;
<a name="l01308"></a>01308  <span class="keywordtype">double</span> noise;
<a name="l01309"></a>01309  <a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *xyz = (<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a>)*<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()*3);
<a name="l01310"></a>01310  ns *= (<a class="code" href="../../dc/d42/classTriangulation.html#a05c3964cb90559996d93566c263e86c5" title="Approximate bounding ball radius. O(N).">getBoundingBallRadius</a>()/100.0);
<a name="l01311"></a>01311 
<a name="l01312"></a>01312  i=0; <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n)
<a name="l01313"></a>01313  {
<a name="l01314"></a>01314   noise = ns*(((((double)rand()))-(((double)RAND_MAX)/2.0))/((<span class="keywordtype">double</span>)RAND_MAX));
<a name="l01315"></a>01315   np = (*v)+((v-&gt;<a class="code" href="../../d2/da0/classVertex.html#a9511252ee9532d689d0a26e0dec4b8fc" title="Normal at the vertex computed as the sum of incident triangle normals weighted on their incidence ang...">getNormal</a>())*noise);
<a name="l01316"></a>01316   xyz[i++]=np.<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>; xyz[i++]=np.<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>; xyz[i++]=np.<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>;
<a name="l01317"></a>01317  }
<a name="l01318"></a>01318  i=0; <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) {v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>=xyz[i++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>=xyz[i++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>=xyz[i++];}
<a name="l01319"></a>01319 
<a name="l01320"></a>01320  free(xyz);
<a name="l01321"></a>01321 }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 
<a name="l01324"></a>01324 <span class="comment">// Iteratively swap edges to maximize the minimum angle.</span>
<a name="l01325"></a>01325 <span class="comment">// Checks and avoids normal inversion.</span>
<a name="l01326"></a>01326 
<a name="l01327"></a><a class="code" href="../../dc/d42/classTriangulation.html#a4d66fa2ec649b4d9f05ca3e5693d22aa">01327</a> <span class="keywordtype">bool</span> <a class="code" href="../../dc/d42/classTriangulation.html#a4d66fa2ec649b4d9f05ca3e5693d22aa" title="Iteratively swaps edges to minimize the Delaunay minimum angle. O(N).">Triangulation::iterativeEdgeSwaps</a>()
<a name="l01328"></a>01328 {
<a name="l01329"></a>01329  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01330"></a>01330  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *f;
<a name="l01331"></a>01331  <span class="keywordtype">double</span> l;
<a name="l01332"></a>01332  <span class="keywordtype">int</span> swaps=1, totits=1;
<a name="l01333"></a>01333  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> n1, n2, nor;
<a name="l01334"></a>01334  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> toswap;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336  <span class="keywordtype">bool</span> selection=0;
<a name="l01337"></a>01337  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01338"></a>01338  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t)) {selection=1; <span class="keywordflow">break</span>;}
<a name="l01339"></a>01339 
<a name="l01340"></a>01340  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(e) &amp;&amp; !e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>())
<a name="l01341"></a>01341  {
<a name="l01342"></a>01342   <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(e); <span class="keywordflow">if</span> ((!selection || (<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>) &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)))) toswap.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(e);
<a name="l01343"></a>01343  }
<a name="l01344"></a>01344 
<a name="l01345"></a>01345  <a class="code" href="../../d3/dab/classJMesh.html#aa77f98e23d311cb8ba63900b0d1f1564">JMesh::begin_progress</a>();
<a name="l01346"></a>01346  <span class="keywordflow">while</span> (swaps &amp;&amp; totits++ &lt; 10)
<a name="l01347"></a>01347  {
<a name="l01348"></a>01348   swaps = 0; <span class="keywordflow">for</span> (n=toswap.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(); n!=NULL; )
<a name="l01349"></a>01349   {
<a name="l01350"></a>01350    e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l01351"></a>01351    if (n==toswap.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>()) {toswap.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(toswap.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>()); n=NULL;}
<a name="l01352"></a>01352    <span class="keywordflow">else</span> {n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(); toswap.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>());}
<a name="l01353"></a>01353    <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(e);
<a name="l01354"></a>01354    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad0ceabf8a4ee4875a29e387ebe625ed3" title="Needle-like degeneracy check.">isNeedle</a>() &amp;&amp; !e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad0ceabf8a4ee4875a29e387ebe625ed3" title="Needle-like degeneracy check.">isNeedle</a>())
<a name="l01355"></a>01355    {
<a name="l01356"></a>01356     n1 = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>();
<a name="l01357"></a>01357     n2 = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>();
<a name="l01358"></a>01358     nor = n1+n2;
<a name="l01359"></a>01359     l = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>();
<a name="l01360"></a>01360     <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>())
<a name="l01361"></a>01361     {
<a name="l01362"></a>01362      <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad0ceabf8a4ee4875a29e387ebe625ed3" title="Needle-like degeneracy check.">isNeedle</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad0ceabf8a4ee4875a29e387ebe625ed3" title="Needle-like degeneracy check.">isNeedle</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>() &lt;= l*1.000001 || nor*e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>() &lt;= 0 || nor*e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>() &lt;= 0) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1);
<a name="l01363"></a>01363      <span class="keywordflow">else</span>
<a name="l01364"></a>01364      {
<a name="l01365"></a>01365       swaps++;
<a name="l01366"></a>01366       f = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(f) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(f) &amp;&amp; !f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(f); toswap.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(f);}
<a name="l01367"></a>01367       f = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(f) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(f) &amp;&amp; !f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(f); toswap.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(f);}
<a name="l01368"></a>01368       f = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(f) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(f) &amp;&amp; !f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(f); toswap.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(f);}
<a name="l01369"></a>01369       f = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(f) &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#ab3d3326b85173a215b5c50b4d76d6d14">IS_SHARPEDGE</a>(f) &amp;&amp; !f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(f); toswap.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(f);}
<a name="l01370"></a>01370      }
<a name="l01371"></a>01371     }
<a name="l01372"></a>01372    }
<a name="l01373"></a>01373   }
<a name="l01374"></a>01374   <a class="code" href="../../d3/dab/classJMesh.html#a8a8ac002feb18f1646c059d745af15c2">JMesh::report_progress</a>(<span class="stringliteral">&quot;Swaps: %d      &quot;</span>, swaps);
<a name="l01375"></a>01375  }
<a name="l01376"></a>01376  <a class="code" href="../../d3/dab/classJMesh.html#a5a38f845d326284196316e21ae8c93d4">JMesh::end_progress</a>();
<a name="l01377"></a>01377 
<a name="l01378"></a>01378  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(e);
<a name="l01379"></a>01379 
<a name="l01380"></a>01380  <span class="keywordflow">if</span> (totits &gt;= 10)
<a name="l01381"></a>01381  {
<a name="l01382"></a>01382   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Optimization did not converge after 10 iterations! Stopping.\n&quot;</span>);
<a name="l01383"></a>01383   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;You may try to run the method again.\n&quot;</span>);
<a name="l01384"></a>01384   <span class="keywordflow">return</span> 0;
<a name="l01385"></a>01385  }
<a name="l01386"></a>01386 
<a name="l01387"></a>01387  <span class="keywordflow">return</span> 1;
<a name="l01388"></a>01388 }
<a name="l01389"></a>01389 
<a name="l01390"></a>01390 
<a name="l01392"></a>01392 <span class="comment">//                                                              //</span>
<a name="l01393"></a>01393 <span class="comment">//    T O P O L O G Y   M A N I P U L A T I O N                 //</span>
<a name="l01394"></a>01394 <span class="comment">//                                                              //</span>
<a name="l01396"></a>01396 <span class="comment"></span>
<a name="l01397"></a>01397 
<a name="l01399"></a>01399 
<a name="l01400"></a><a class="code" href="../../dc/d42/classTriangulation.html#a49bd77069541bb23f87674e1cc6bb21a">01400</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a49bd77069541bb23f87674e1cc6bb21a" title="Invert all the triangle and edge orientations. O(N).">Triangulation::flipNormals</a>()
<a name="l01401"></a>01401 {
<a name="l01402"></a>01402  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01403"></a>01403  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01404"></a>01404  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01405"></a>01405 
<a name="l01406"></a>01406  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a97fcb5e4aa239bc80ef8bbcfef0a9b3b" title="Inverts the orientation of the triangle.">invert</a>();
<a name="l01407"></a>01407  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l01408"></a>01408 }
<a name="l01409"></a>01409 
<a name="l01410"></a>01410 
<a name="l01412"></a>01412 
<a name="l01413"></a><a class="code" href="../../dc/d42/classTriangulation.html#a83ba227521b587e76bddb5d48d1959d7">01413</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#a49bd77069541bb23f87674e1cc6bb21a" title="Invert all the triangle and edge orientations. O(N).">Triangulation::flipNormals</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l01414"></a>01414 {
<a name="l01415"></a>01415  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo;
<a name="l01416"></a>01416  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l01417"></a>01417 
<a name="l01418"></a>01418  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0);
<a name="l01419"></a>01419  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01420"></a>01420  {
<a name="l01421"></a>01421   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01422"></a>01422   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t,2))
<a name="l01423"></a>01423   {
<a name="l01424"></a>01424    t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l01425"></a>01425 
<a name="l01426"></a>01426    <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t1,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);
<a name="l01427"></a>01427    <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t2,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);
<a name="l01428"></a>01428    <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t3,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);
<a name="l01429"></a>01429 
<a name="l01430"></a>01430    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a97fcb5e4aa239bc80ef8bbcfef0a9b3b" title="Inverts the orientation of the triangle.">invert</a>();
<a name="l01431"></a>01431    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>,2)) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l01432"></a>01432    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>,2)) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l01433"></a>01433    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>,2)) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l01434"></a>01434    <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>,2); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>,2); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>,2);
<a name="l01435"></a>01435    <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t,2);
<a name="l01436"></a>01436   }
<a name="l01437"></a>01437  }
<a name="l01438"></a>01438 
<a name="l01439"></a>01439  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0);
<a name="l01440"></a>01440  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01441"></a>01441  {
<a name="l01442"></a>01442   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01443"></a>01443   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t,2))
<a name="l01444"></a>01444   {
<a name="l01445"></a>01445    t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l01446"></a>01446 
<a name="l01447"></a>01447    <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t1,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);
<a name="l01448"></a>01448    <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t2,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);
<a name="l01449"></a>01449    <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; <a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t3,2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);
<a name="l01450"></a>01450 
<a name="l01451"></a>01451    <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>,2); <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>,2); <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>,2);
<a name="l01452"></a>01452    <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t,2);
<a name="l01453"></a>01453   }
<a name="l01454"></a>01454  }
<a name="l01455"></a>01455 }
<a name="l01456"></a>01456 
<a name="l01457"></a>01457 
<a name="l01459"></a>01459 
<a name="l01460"></a><a class="code" href="../../dc/d42/classTriangulation.html#ab202930f0c1041cdf2378ba30b7170a3">01460</a> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *<a class="code" href="../../dc/d42/classTriangulation.html#ab202930f0c1041cdf2378ba30b7170a3" title="Return the triangle with the maximum &#39;z&#39; coordinate in the shell containing &#39;t0&#39;. O(N)...">Triangulation::topTriangle</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l01461"></a>01461 {
<a name="l01462"></a>01462  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01463"></a>01463  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *hv = NULL, *v1, *v2, *v3;
<a name="l01464"></a>01464  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *fe = NULL;
<a name="l01465"></a>01465  <a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> az, Mz = -<a class="code" href="../../d3/da2/j__mesh_8h.html#a20a507a6e9c48f01d270604cc195c419">COORD_MAX</a>;
<a name="l01466"></a>01466  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l01467"></a>01467  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve, todo, tlist, elist, vlist;
<a name="l01468"></a>01468 
<a name="l01469"></a>01469  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t0,2);
<a name="l01470"></a>01470 
<a name="l01471"></a>01471  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01472"></a>01472  {
<a name="l01473"></a>01473   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>(); tlist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01474"></a>01474   t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l01475"></a>01475   v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l01476"></a>01476   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v1)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v1); vlist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v1);}
<a name="l01477"></a>01477   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v2)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v2); vlist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v2);}
<a name="l01478"></a>01478   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v3)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v3); vlist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v3);}
<a name="l01479"></a>01479 
<a name="l01480"></a>01480   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>);}
<a name="l01481"></a>01481   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>);}
<a name="l01482"></a>01482   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>);}
<a name="l01483"></a>01483 
<a name="l01484"></a>01484   <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t1,2)) {<a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t1,2); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);}
<a name="l01485"></a>01485   <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t2,2)) {<a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t2,2); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);}
<a name="l01486"></a>01486   <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t3,2)) {<a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t3,2); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);}
<a name="l01487"></a>01487  }
<a name="l01488"></a>01488 
<a name="l01489"></a>01489  ve = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l01490"></a>01490 
<a name="l01491"></a>01491  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(vlist)), v, n) {<a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v); <span class="keywordflow">if</span> ((az = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>) &gt; Mz) {Mz=az; hv = v;}}
<a name="l01492"></a>01492  Mz = <a class="code" href="../../d3/da2/j__mesh_8h.html#a20a507a6e9c48f01d270604cc195c419">COORD_MAX</a>;
<a name="l01493"></a>01493  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(elist)), e, n) {<a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(e); <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a63613c87061cd892d2cb135651b8f492" title="TRUE iff &#39;v&#39; is an end-point of the edge.">hasVertex</a>(hv) &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad17bb4381bc6d385384b39da49209bfe" title="Euclidean length of the edge.">length</a>() != 0) ve-&gt;<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);}
<a name="l01494"></a>01494  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(tlist)), t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t, 2);
<a name="l01495"></a>01495 
<a name="l01496"></a>01496  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, n)
<a name="l01497"></a>01497   <span class="keywordflow">if</span> ((az = (hv-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> - e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(hv)-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>)/e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad17bb4381bc6d385384b39da49209bfe" title="Euclidean length of the edge.">length</a>()) &lt; Mz) {Mz=az; fe = e;}
<a name="l01498"></a>01498  <span class="keyword">delete</span>(ve);
<a name="l01499"></a>01499 
<a name="l01500"></a>01500  <span class="keywordflow">if</span> (fe == NULL) fe = hv-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>;
<a name="l01501"></a>01501  <span class="keywordflow">if</span> (fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL || fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) <span class="keywordflow">return</span> NULL;
<a name="l01502"></a>01502 
<a name="l01503"></a>01503  <span class="keywordflow">return</span> (fabs(fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>().<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>) &gt; fabs(fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>().<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>))?(fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>):(fe-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l01504"></a>01504 }
<a name="l01505"></a>01505 
<a name="l01506"></a>01506 
<a name="l01508"></a>01508 
<a name="l01509"></a><a class="code" href="../../dc/d42/classTriangulation.html#ab9694f134bbc51c81b8dfe675fa8ecd4">01509</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#ab9694f134bbc51c81b8dfe675fa8ecd4" title="Updates the values of n_boundaries, n_handles and n_shells. O(N).">Triangulation::eulerUpdate</a>()
<a name="l01510"></a>01510 {
<a name="l01511"></a>01511  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v,*w;
<a name="l01512"></a>01512  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01513"></a>01513  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t,*s;
<a name="l01514"></a>01514  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList;
<a name="l01515"></a>01515  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01516"></a>01516  <a class="code" href="../../dc/d42/classTriangulation.html#a98cfd7aaa3a8bb5a9b13c43895604ab2" title="Number of boundary loops.">n_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a7c028d3bf49ef217cc6630099fd41fae" title="Number of connected components.">n_shells</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a9610b511e11ad1a44f9b84441f16c165" title="Number of handles.">n_handles</a> = 0;
<a name="l01517"></a>01517 
<a name="l01518"></a>01518  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(t, 3))
<a name="l01519"></a>01519  {
<a name="l01520"></a>01520   <a class="code" href="../../dc/d42/classTriangulation.html#a7c028d3bf49ef217cc6630099fd41fae" title="Number of connected components.">n_shells</a>++;
<a name="l01521"></a>01521   triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01522"></a>01522   <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t,3);
<a name="l01523"></a>01523 
<a name="l01524"></a>01524   <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01525"></a>01525   {
<a name="l01526"></a>01526    t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01527"></a>01527    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l01528"></a>01528    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l01529"></a>01529    <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3)) {triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3);}
<a name="l01530"></a>01530   }
<a name="l01531"></a>01531  }
<a name="l01532"></a>01532  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t, 3);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>())
<a name="l01535"></a>01535   {<a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, 3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, 3);}
<a name="l01536"></a>01536 
<a name="l01537"></a>01537  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(v,3))
<a name="l01538"></a>01538  {
<a name="l01539"></a>01539   <a class="code" href="../../dc/d42/classTriangulation.html#a98cfd7aaa3a8bb5a9b13c43895604ab2" title="Number of boundary loops.">n_boundaries</a>++;
<a name="l01540"></a>01540   <span class="keywordflow">for</span> (w=v; <a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(w, 3); w = w-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa39f34a08953a1a6b7954852d4a5ea9d" title="Returns the vertex following this one on the boundary.">nextOnBoundary</a>()) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(w, 3);
<a name="l01541"></a>01541  }
<a name="l01542"></a>01542 
<a name="l01543"></a>01543  <a class="code" href="../../dc/d42/classTriangulation.html#a9610b511e11ad1a44f9b84441f16c165" title="Number of handles.">n_handles</a> = (<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() - <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() - <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() + 2*<a class="code" href="../../dc/d42/classTriangulation.html#a7c028d3bf49ef217cc6630099fd41fae" title="Number of connected components.">n_shells</a> - <a class="code" href="../../dc/d42/classTriangulation.html#a98cfd7aaa3a8bb5a9b13c43895604ab2" title="Number of boundary loops.">n_boundaries</a>)/2;
<a name="l01544"></a>01544  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 0;
<a name="l01545"></a>01545 }
<a name="l01546"></a>01546 
<a name="l01547"></a>01547 
<a name="l01548"></a>01548 <span class="comment">// Makes the mesh equivalent to a topological disk.</span>
<a name="l01549"></a>01549 <span class="comment">// Edges and vertices are duplicated when necessary.</span>
<a name="l01550"></a>01550 
<a name="l01551"></a><a class="code" href="../../dc/d42/classTriangulation.html#ae07118d06defaf868b4e30c62c889d8e">01551</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#ae07118d06defaf868b4e30c62c889d8e" title="Duplicates edges and vertices to make the mesh homeomorphic to a disk. O(N).">Triangulation::openToDisk</a>()
<a name="l01552"></a>01552 {
<a name="l01553"></a>01553  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l01554"></a>01554  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *s;
<a name="l01555"></a>01555  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> triList, *ve;
<a name="l01556"></a>01556  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *w;
<a name="l01557"></a>01557  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *ne;
<a name="l01558"></a>01558  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01559"></a>01559  triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01560"></a>01560  <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t,3);
<a name="l01561"></a>01561 
<a name="l01562"></a>01562  <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01563"></a>01563  {
<a name="l01564"></a>01564   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01565"></a>01565   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3))
<a name="l01566"></a>01566    {triList.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>,3);}
<a name="l01567"></a>01567   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3))
<a name="l01568"></a>01568    {triList.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>,3);}
<a name="l01569"></a>01569   <span class="keywordflow">if</span> ((s = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>()) != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(s,3))
<a name="l01570"></a>01570    {triList.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(s); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(s,3); <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>,3);}
<a name="l01571"></a>01571  }
<a name="l01572"></a>01572  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a> (t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(t, 3);
<a name="l01573"></a>01573 
<a name="l01574"></a>01574  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l01575"></a>01575 
<a name="l01576"></a>01576  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(e, 3))
<a name="l01577"></a>01577  {
<a name="l01578"></a>01578   ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;appendHead(e);
<a name="l01579"></a>01579   ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;appendHead(e);
<a name="l01580"></a>01580  }
<a name="l01581"></a>01581 
<a name="l01582"></a>01582  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <span class="keywordflow">if</span> (((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;numels()==1) triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l01583"></a>01583  <span class="keywordflow">if</span> (!triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <a class="code" href="../../d3/dab/classJMesh.html#a5cd94530c89520f54ba406a90f623cde">JMesh::error</a>(<span class="stringliteral">&quot;Triangulation::openToDisk: Couldn&#39;t find a root.\n&quot;</span>);
<a name="l01584"></a>01584 
<a name="l01585"></a>01585  <span class="keywordflow">while</span>(triList.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01586"></a>01586  {
<a name="l01587"></a>01587   v = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)triList.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01588"></a>01588   ve = ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>);
<a name="l01589"></a>01589   <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01590"></a>01590   {
<a name="l01591"></a>01591    e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)(ve-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01592"></a>01592    <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(e, 3);
<a name="l01593"></a>01593    ve-&gt;<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l01594"></a>01594    w = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(v);
<a name="l01595"></a>01595    ve = ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)w-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>);
<a name="l01596"></a>01596    ve-&gt;<a class="code" href="../../d6/da9/classList.html#a50ead1d3e16bc1a1672eda5c2db6d4d5" title="Deletes and removes the node containing &#39;d&#39;. Returns its position, 0 if &#39;d&#39; is not in the list...">removeNode</a>(e);
<a name="l01597"></a>01597    <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() == 1) triList.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(w);
<a name="l01598"></a>01598   }
<a name="l01599"></a>01599   <span class="keywordflow">else</span>
<a name="l01600"></a>01600   {
<a name="l01601"></a>01601    ve = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l01602"></a>01602    e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)ve-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>; <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(e, 3); ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;appendHead(e);
<a name="l01603"></a>01603    e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)ve-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>; <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(e, 3); ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)-&gt;appendHead(e);
<a name="l01604"></a>01604    <span class="keyword">delete</span>(ve);
<a name="l01605"></a>01605   }
<a name="l01606"></a>01606  }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(e, 3) &amp;&amp; !e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>())
<a name="l01609"></a>01609  {
<a name="l01610"></a>01610   ne = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>);
<a name="l01611"></a>01611   ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = NULL; <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne);
<a name="l01612"></a>01612   ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(e, ne);
<a name="l01613"></a>01613  }
<a name="l01614"></a>01614 
<a name="l01615"></a>01615  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a65ba1ac28b112120b3b44e0d0b458fac">UNMARK_BIT</a>(e, 3);
<a name="l01616"></a>01616 
<a name="l01617"></a>01617  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>) {<span class="keyword">delete</span>(((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a>)); v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a718a8d199ac590f461b31f76a09fea35" title="Further information.">info</a> = NULL;}
<a name="l01618"></a>01618  <a class="code" href="../../dc/d42/classTriangulation.html#a42e3d87b90251c958abe310830303ac5">duplicateNonManifoldVertices</a>();
<a name="l01619"></a>01619  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l01620"></a>01620 }
<a name="l01621"></a>01621 
<a name="l01622"></a>01622 
<a name="l01624"></a>01624 <span class="comment">//                                                              //</span>
<a name="l01625"></a>01625 <span class="comment">//    T R I A N G U L A T I O N   M E T H O D S                 //</span>
<a name="l01626"></a>01626 <span class="comment">//                                                              //</span>
<a name="l01628"></a>01628 <span class="comment"></span>
<a name="l01629"></a>01629 
<a name="l01631"></a>01631 
<a name="l01632"></a><a class="code" href="../../dc/d42/classTriangulation.html#ac83bd24ec2fd54196f64f9a238342049">01632</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#ac83bd24ec2fd54196f64f9a238342049">Triangulation::StarTriangulateHole</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e)
<a name="l01633"></a>01633 {
<a name="l01634"></a>01634  <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) <span class="keywordflow">return</span> 0;
<a name="l01635"></a>01635 
<a name="l01636"></a>01636  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bvs;
<a name="l01637"></a>01637  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l01638"></a>01638  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, *e2, *e3;
<a name="l01639"></a>01639  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> np;
<a name="l01640"></a>01640  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *nv, *v1, *v2;
<a name="l01641"></a>01641  <span class="keywordtype">int</span> nt=0;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643  v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;
<a name="l01644"></a>01644 
<a name="l01645"></a>01645  <span class="keywordflow">do</span>
<a name="l01646"></a>01646  {
<a name="l01647"></a>01647   bvs.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l01648"></a>01648   v = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa39f34a08953a1a6b7954852d4a5ea9d" title="Returns the vertex following this one on the boundary.">nextOnBoundary</a>();
<a name="l01649"></a>01649  } <span class="keywordflow">while</span> (v != e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>);
<a name="l01650"></a>01650 
<a name="l01651"></a>01651  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bvs)), v, n) np = np+(*v);
<a name="l01652"></a>01652 
<a name="l01653"></a>01653  np = np/bvs.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>();
<a name="l01654"></a>01654  nv = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(&amp;np);
<a name="l01655"></a>01655  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nv);
<a name="l01656"></a>01656 
<a name="l01657"></a>01657  v1 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)bvs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01658"></a>01658  e1 = <a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f" title="Creates an Edge connecting two existing mesh vertices.">CreateEdge</a>(nv, v1);
<a name="l01659"></a>01659  <span class="keywordflow">for</span> (n=bvs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(); n!=NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>())
<a name="l01660"></a>01660  {
<a name="l01661"></a>01661   v2 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01662"></a>01662   e2 = <a class="code" href="../../dc/d42/classTriangulation.html#af7bbd9c669f416a29cd69aab40f2178f" title="Creates an Edge connecting two existing mesh vertices.">CreateEdge</a>(nv, v2);
<a name="l01663"></a>01663   e3 = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2);
<a name="l01664"></a>01664   <a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">CreateTriangle</a>(e1, e2, e3);
<a name="l01665"></a>01665   nt++;
<a name="l01666"></a>01666   v1 = v2;
<a name="l01667"></a>01667   e1 = e2;
<a name="l01668"></a>01668  }
<a name="l01669"></a>01669  v2 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)bvs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01670"></a>01670  e2 = nv-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2);
<a name="l01671"></a>01671  e3 = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2);
<a name="l01672"></a>01672  <a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">CreateTriangle</a>(e1, e2, e3);
<a name="l01673"></a>01673  nt++;
<a name="l01674"></a>01674 
<a name="l01675"></a>01675  <span class="keywordflow">return</span> nt;
<a name="l01676"></a>01676 }
<a name="l01677"></a>01677 
<a name="l01678"></a>01678 
<a name="l01680"></a>01680 
<a name="l01681"></a><a class="code" href="../../dc/d42/classTriangulation.html#a777e577009b7e36cb1eb2d764979f2c6">01681</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a777e577009b7e36cb1eb2d764979f2c6">Triangulation::TriangulateHole</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *nor)
<a name="l01682"></a>01682 {
<a name="l01683"></a>01683  <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) <span class="keywordflow">return</span> 0;
<a name="l01684"></a>01684 
<a name="l01685"></a>01685  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bvs;
<a name="l01686"></a>01686  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n, *gn = NULL;
<a name="l01687"></a>01687  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, *e2;
<a name="l01688"></a>01688  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *v1, *v2;
<a name="l01689"></a>01689  <span class="keywordtype">double</span> ang, gang;
<a name="l01690"></a>01690  <span class="keywordtype">int</span> nt = 0;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692  v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;
<a name="l01693"></a>01693  <span class="keywordflow">do</span>
<a name="l01694"></a>01694  {
<a name="l01695"></a>01695   bvs.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l01696"></a>01696   v = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa39f34a08953a1a6b7954852d4a5ea9d" title="Returns the vertex following this one on the boundary.">nextOnBoundary</a>();
<a name="l01697"></a>01697  } <span class="keywordflow">while</span> (v != e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>);
<a name="l01698"></a>01698 
<a name="l01699"></a>01699  <span class="keywordflow">while</span> (bvs.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &gt; 2)
<a name="l01700"></a>01700  {
<a name="l01701"></a>01701   gang = DBL_MAX;
<a name="l01702"></a>01702   <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bvs)), v, n)
<a name="l01703"></a>01703    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v) &amp;&amp; v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> &amp;&amp; (ang = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#afe64cff48a7497d4a1ee59c2f6745106" title="Discriminant Angle for triangulating flat (or nearly flat) polygons.">getAngleOnAveragePlane</a>(nor)) &lt; gang)
<a name="l01704"></a>01704     {gang = ang; gn = n;}
<a name="l01705"></a>01705   <span class="keywordflow">if</span> (gang == DBL_MAX)
<a name="l01706"></a>01706   {
<a name="l01707"></a>01707    <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;TriangulateHole: Can&#39;t complete the triangulation.\n&quot;</span>);
<a name="l01708"></a>01708    <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bvs)), v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l01709"></a>01709    <span class="keywordflow">return</span> 0;
<a name="l01710"></a>01710   }
<a name="l01711"></a>01711   v = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01712"></a>01712   v1 = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)((gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>() != NULL)?(gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()):(bvs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()))-&gt;data;
<a name="l01713"></a>01713   v2 = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)((gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>() != NULL)?(gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()):(bvs.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>()))-&gt;data;
<a name="l01714"></a>01714   e1 = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v1);
<a name="l01715"></a>01715   e2 = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2);
<a name="l01716"></a>01716   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d42/classTriangulation.html#ae6106620e0853f98aded0112640dea4d" title="Creates a new Edge &#39;e&#39; and an oriented Triangle bounded by &#39;e&#39;, &#39;e1&#39; and &#39;e2&#39;.">EulerEdgeTriangle</a>(e1,e2)) <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v);
<a name="l01717"></a>01717   <span class="keywordflow">else</span> {bvs.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(gn); <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v1); <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v2); nt++;}
<a name="l01718"></a>01718  }
<a name="l01719"></a>01719 
<a name="l01720"></a>01720  <span class="keywordtype">int</span> i, skips;
<a name="l01721"></a>01721  <span class="keywordflow">do</span>
<a name="l01722"></a>01722  {
<a name="l01723"></a>01723   skips = 0;
<a name="l01724"></a>01724   <span class="keywordflow">for</span> (n=<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(), i=2*nt*nt; i&lt;nt; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(), i--)
<a name="l01725"></a>01725   {
<a name="l01726"></a>01726    e = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01727"></a>01727    ang = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>();
<a name="l01728"></a>01728    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>())
<a name="l01729"></a>01729     {<span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>() &lt;= ang) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">else</span> skips++;}
<a name="l01730"></a>01730   }
<a name="l01731"></a>01731   <span class="keywordflow">if</span> (i &lt; 0) {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Optimization is taking too long. I give up.\n&quot;</span>); <span class="keywordflow">break</span>;}
<a name="l01732"></a>01732  } <span class="keywordflow">while</span> (skips);
<a name="l01733"></a>01733 
<a name="l01734"></a>01734  <span class="keywordflow">return</span> nt;
<a name="l01735"></a>01735 }
<a name="l01736"></a>01736 
<a name="l01737"></a>01737 
<a name="l01739"></a>01739 
<a name="l01740"></a><a class="code" href="../../dc/d42/classTriangulation.html#ad90c6217b57e3f9730da3b99942ed5af">01740</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a777e577009b7e36cb1eb2d764979f2c6">Triangulation::TriangulateHole</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *vl)
<a name="l01741"></a>01741 {
<a name="l01742"></a>01742  <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) <span class="keywordflow">return</span> 0;
<a name="l01743"></a>01743 
<a name="l01744"></a>01744  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bvs, ovbs, nedg;
<a name="l01745"></a>01745  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n, *gn = NULL;
<a name="l01746"></a>01746  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, *e2;
<a name="l01747"></a>01747  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *v1, *v2;
<a name="l01748"></a>01748  <span class="keywordtype">double</span> ang, gang;
<a name="l01749"></a>01749  <span class="keywordtype">int</span> nt = 0, neb;
<a name="l01750"></a>01750 
<a name="l01751"></a>01751  v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;
<a name="l01752"></a>01752 
<a name="l01753"></a>01753  <span class="keywordflow">do</span>
<a name="l01754"></a>01754  {
<a name="l01755"></a>01755   bvs.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l01756"></a>01756   v = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa39f34a08953a1a6b7954852d4a5ea9d" title="Returns the vertex following this one on the boundary.">nextOnBoundary</a>();
<a name="l01757"></a>01757  } <span class="keywordflow">while</span> (v != e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>);
<a name="l01758"></a>01758  ovbs.<a class="code" href="../../d6/da9/classList.html#ab8c88745bff02c6fdeacde1d8f3841de" title="Appends a list &#39;l&#39; to the head by duplicating nodes in &#39;l&#39;.   O(l-&gt;numels()).">appendList</a>(&amp;bvs);
<a name="l01759"></a>01759 
<a name="l01760"></a>01760  <span class="keywordflow">while</span> (bvs.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &gt; 2) <span class="comment">// While there are more than two boundary vertices</span>
<a name="l01761"></a>01761  {
<a name="l01762"></a>01762   gang = DBL_MAX;
<a name="l01763"></a>01763   <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bvs)), v, n)
<a name="l01764"></a>01764    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v) &amp;&amp; v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> &amp;&amp; (ang = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#a334250a8478a69bb1adcbb9317f63ee7" title="Discriminant Angle for triangulating 3D polygons.">getAngleForTriangulation</a>()) &lt; gang)
<a name="l01765"></a>01765     {gang = ang; gn = n;}
<a name="l01766"></a>01766   <span class="keywordflow">if</span> (gang == DBL_MAX)
<a name="l01767"></a>01767   {
<a name="l01768"></a>01768    <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;TriangulateHole: Can&#39;t complete the triangulation.\n&quot;</span>);
<a name="l01769"></a>01769    <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bvs)), v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l01770"></a>01770    <span class="keywordflow">return</span> 0;
<a name="l01771"></a>01771   }
<a name="l01772"></a>01772   v = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01773"></a>01773   v1 = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)((gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>() != NULL)?(gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()):(bvs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()))-&gt;data;
<a name="l01774"></a>01774   v2 = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)((gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>() != NULL)?(gn-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()):(bvs.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>()))-&gt;data;
<a name="l01775"></a>01775   e1 = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v1);
<a name="l01776"></a>01776   e2 = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2);
<a name="l01777"></a>01777   neb = <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>();
<a name="l01778"></a>01778   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d42/classTriangulation.html#ae6106620e0853f98aded0112640dea4d" title="Creates a new Edge &#39;e&#39; and an oriented Triangle bounded by &#39;e&#39;, &#39;e1&#39; and &#39;e2&#39;.">EulerEdgeTriangle</a>(e1,e2)) <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v);
<a name="l01779"></a>01779   <span class="keywordflow">else</span>
<a name="l01780"></a>01780   {
<a name="l01781"></a>01781    bvs.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(gn);
<a name="l01782"></a>01782    <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v1);
<a name="l01783"></a>01783    <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v2);
<a name="l01784"></a>01784    nt++;
<a name="l01785"></a>01785    <span class="keywordflow">if</span> (<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() &gt; neb) nedg.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01786"></a>01786   }
<a name="l01787"></a>01787  }
<a name="l01788"></a>01788 
<a name="l01789"></a>01789 <span class="comment">// if (nt &lt; 2) return nt;</span>
<a name="l01790"></a>01790 
<a name="l01791"></a>01791  <span class="comment">// Calcolo una normale per il buco come media dei nuovi triangoli</span>
<a name="l01792"></a>01792  <span class="keywordtype">int</span> i;
<a name="l01793"></a>01793  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> nor;
<a name="l01794"></a>01794 
<a name="l01795"></a>01795  <span class="keywordflow">for</span> (i=0, n=<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(); i&lt;nt; i++, n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()) nor = nor+((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;data)-&gt;getNormal();
<a name="l01796"></a>01796  <span class="keywordflow">if</span> (nor.<a class="code" href="../../dc/d4f/classPoint.html#a41f4004d88e228cb0b974d0541eca087" title="TRUE if vector is (0,0,0)">isNull</a>())
<a name="l01797"></a>01797  {
<a name="l01798"></a>01798   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;TriangulateHole: Unable to compute an average normal. Can&#39;t optimize.\n&quot;</span>);
<a name="l01799"></a>01799   <span class="keywordflow">return</span> nt;
<a name="l01800"></a>01800  }
<a name="l01801"></a>01801  nor.<a class="code" href="../../dc/d4f/classPoint.html#aef2212b0f31228e803ecbf389bfe7302" title="Divides the vector by its length. If isNull() the application exits with an error.">normalize</a>();
<a name="l01802"></a>01802  
<a name="l01803"></a>01803  <span class="comment">// Memorizzo da qualche parte la posizione originale dei vertici</span>
<a name="l01804"></a>01804  <span class="comment">// e Proietto il boundary sul piano con normale quella appena calcolata</span>
<a name="l01805"></a>01805  <a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *ovps = (<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *)malloc((ovbs.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())*3*<span class="keyword">sizeof</span>(<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a>));
<a name="l01806"></a>01806  <span class="keywordtype">int</span> j = 0;
<a name="l01807"></a>01807  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(ovbs)), v, n)
<a name="l01808"></a>01808  {
<a name="l01809"></a>01809   ovps[j++] = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>; ovps[j++] = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>; ovps[j++] = v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>;
<a name="l01810"></a>01810   v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a452c6780f5ef5207a3ccf12aba54d18a" title="Projects the vector on the plane with normal &#39;n&#39; passing through the origin.">project</a>(&amp;nor);
<a name="l01811"></a>01811  }
<a name="l01812"></a>01812 
<a name="l01813"></a>01813  <span class="comment">// Proietto i punti interni sul piano d&#39;appoggio</span>
<a name="l01814"></a>01814  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *p;
<a name="l01815"></a>01815  <a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *ovpsi = (<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a> *)malloc((vl-&gt;<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())*3*<span class="keyword">sizeof</span>(<a class="code" href="../../d3/da2/j__mesh_8h.html#ac22461b2c8e5b53fa7ff1384513748a2">coord</a>));
<a name="l01816"></a>01816  j = 0;
<a name="l01817"></a>01817  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>((*vl), n)
<a name="l01818"></a>01818  {
<a name="l01819"></a>01819   p = ((<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *)n-&gt;data);
<a name="l01820"></a>01820   ovpsi[j++] = p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>; ovpsi[j++] = p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>; ovpsi[j++] = p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>;
<a name="l01821"></a>01821  }
<a name="l01822"></a>01822  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>((*vl), n)
<a name="l01823"></a>01823  {
<a name="l01824"></a>01824   p = ((<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *)n-&gt;data);
<a name="l01825"></a>01825   p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a452c6780f5ef5207a3ccf12aba54d18a" title="Projects the vector on the plane with normal &#39;n&#39; passing through the origin.">project</a>(&amp;nor);
<a name="l01826"></a>01826  }
<a name="l01827"></a>01827 
<a name="l01828"></a>01828  <span class="comment">// Ottimizzo secondo Delaunay vincolato al boundary la nuova regione</span>
<a name="l01829"></a>01829 
<a name="l01830"></a>01830  <span class="keywordtype">int</span> sw;
<a name="l01831"></a>01831  <span class="keywordflow">do</span>
<a name="l01832"></a>01832  {
<a name="l01833"></a>01833   sw = 0;
<a name="l01834"></a>01834   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(nedg)), e1, n)
<a name="l01835"></a>01835   {
<a name="l01836"></a>01836    ang = e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>();
<a name="l01837"></a>01837    <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>())
<a name="l01838"></a>01838     {<span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9c2a7ff97f8c3acc3132ae7b8405b528" title="Return the minimum among the six angles of the two incident triangles.2PI if on boundary.">delaunayMinAngle</a>() &lt;= ang) e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">else</span> sw++;}
<a name="l01839"></a>01839   }
<a name="l01840"></a>01840  } <span class="keywordflow">while</span> (sw);
<a name="l01841"></a>01841 
<a name="l01842"></a>01842  <span class="comment">// Inserisco i punti interni</span>
<a name="l01843"></a>01843  <span class="keywordtype">int</span> ntt = <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()-nt;
<a name="l01844"></a>01844  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> ivs;
<a name="l01845"></a>01845 
<a name="l01846"></a>01846  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>((*vl), n)
<a name="l01847"></a>01847  {
<a name="l01848"></a>01848   p = ((<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *)n-&gt;data);
<a name="l01849"></a>01849   ivs.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(<a class="code" href="../../dc/d42/classTriangulation.html#adc24c811ba3d8689e82ab208faf171c7">watsonInsert</a>(p, &amp;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>, <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()-ntt));
<a name="l01850"></a>01850  }
<a name="l01851"></a>01851  nt = (<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() - ntt);
<a name="l01852"></a>01852 
<a name="l01853"></a>01853  <span class="comment">// Riporto i vertici interni al loro posto</span>
<a name="l01854"></a>01854  j=0; <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(ivs)), v, n)
<a name="l01855"></a>01855  {
<a name="l01856"></a>01856   <span class="keywordflow">if</span> (v != NULL)
<a name="l01857"></a>01857   {
<a name="l01858"></a>01858    v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = ovpsi[j++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = ovpsi[j++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = ovpsi[j++];
<a name="l01859"></a>01859   } <span class="keywordflow">else</span> j+=3;
<a name="l01860"></a>01860  }
<a name="l01861"></a>01861  free(ovpsi);
<a name="l01862"></a>01862 
<a name="l01863"></a>01863  <span class="comment">// Riporto i vertici del boundary al loro posto</span>
<a name="l01864"></a>01864  j=0; <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(ovbs)), v, n)
<a name="l01865"></a>01865  {
<a name="l01866"></a>01866   v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a> = ovps[j++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a> = ovps[j++]; v-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> = ovps[j++];
<a name="l01867"></a>01867  }
<a name="l01868"></a>01868  free(ovps);
<a name="l01869"></a>01869 
<a name="l01870"></a>01870  <span class="keywordflow">return</span> nt;
<a name="l01871"></a>01871 }
<a name="l01872"></a>01872 
<a name="l01873"></a>01873 
<a name="l01875"></a>01875 
<a name="l01876"></a><a class="code" href="../../dc/d42/classTriangulation.html#adc24c811ba3d8689e82ab208faf171c7">01876</a> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *<a class="code" href="../../dc/d42/classTriangulation.html#adc24c811ba3d8689e82ab208faf171c7">Triangulation::watsonInsert</a>(<a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *p, <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *tR, <span class="keywordtype">int</span> nt)
<a name="l01877"></a>01877 {
<a name="l01878"></a>01878  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n, *m;
<a name="l01879"></a>01879  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l01880"></a>01880  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01881"></a>01881  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bdr, bdrs, todo, *ve;
<a name="l01882"></a>01882  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1, *v2, *v3;
<a name="l01883"></a>01883  <span class="keywordtype">int</span> i;
<a name="l01884"></a>01884 
<a name="l01885"></a>01885  <span class="keywordflow">for</span> (i=0, n = <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(); i&lt;nt; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(), i++)
<a name="l01886"></a>01886  {
<a name="l01887"></a>01887   t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01888"></a>01888   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> != NULL &amp;&amp; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4612c8f355e84e767103ff0b17af166b" title="TRUE iff &#39;p&#39; is inside the triangle&#39;s bounding sphere.">inSphere</a>(p))
<a name="l01889"></a>01889   {
<a name="l01890"></a>01890    v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>(); v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>(); v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l01891"></a>01891    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v1)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v1);
<a name="l01892"></a>01892    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v2)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v2);
<a name="l01893"></a>01893    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a7e40f1fb165f7b591f8f222f8b520b7e">IS_VISITED</a>(v3)) bdr.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v3);
<a name="l01894"></a>01894    <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v1); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v2); <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(v3);
<a name="l01895"></a>01895    <a class="code" href="../../d5/dc3/tin_8h.html#a32f74051b9395377a53d7d367440c3c1">MARK_BIT</a>(t, 3);
<a name="l01896"></a>01896    todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l01897"></a>01897   }
<a name="l01898"></a>01898  }
<a name="l01899"></a>01899  <span class="keywordflow">if</span> (bdr.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>() == 0) <span class="keywordflow">return</span> NULL;
<a name="l01900"></a>01900 
<a name="l01901"></a>01901  <a class="code" href="../../df/d37/vertex_8h.html#a5c15ffc27b99ff6c0408b4a028ff4141" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of vertices &#39;v&#39;.">FOREACHVVVERTEX</a>((&amp;(bdr)), v1, n)
<a name="l01902"></a>01902  {
<a name="l01903"></a>01903   ve = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l01904"></a>01904   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e, m) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>, 3) || !<a class="code" href="../../d5/dc3/tin_8h.html#a2aacfedf31aac746bfce635caa9ccdf7">IS_BIT</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>, 3)) v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l01905"></a>01905   <span class="keyword">delete</span>(ve);
<a name="l01906"></a>01906  }
<a name="l01907"></a>01907 
<a name="l01908"></a>01908  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l01909"></a>01909  {
<a name="l01910"></a>01910   t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01911"></a>01911   todo.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>());
<a name="l01912"></a>01912   <a class="code" href="../../dc/d42/classTriangulation.html#a8f482a51bb802c2eabc45310016e2fe3" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangleNoManifold</a>(t);
<a name="l01913"></a>01913  }
<a name="l01914"></a>01914 
<a name="l01915"></a>01915  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *tmp;
<a name="l01916"></a>01916  <span class="keywordflow">for</span> (i=0, n = <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(); i&lt;nt; i++)
<a name="l01917"></a>01917  {
<a name="l01918"></a>01918   t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01919"></a>01919   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> == NULL) {tmp = n; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(); <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a8579fefd20f1ed4c578fb65d5f29845b" title="Deletes and removes the node &#39;n&#39; from the list and frees data memory.   O(1).">freeCell</a>(tmp);}
<a name="l01920"></a>01920   <span class="keywordflow">else</span> n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l01921"></a>01921  }
<a name="l01922"></a>01922 
<a name="l01923"></a>01923  <span class="keywordflow">for</span> (n = bdr.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(); n!=NULL;)
<a name="l01924"></a>01924  {
<a name="l01925"></a>01925   v1 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01926"></a>01926   <span class="keywordflow">if</span> (v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> == NULL) {tmp = n; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(); bdr.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(tmp);}
<a name="l01927"></a>01927   <span class="keywordflow">else</span> n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l01928"></a>01928  }
<a name="l01929"></a>01929 
<a name="l01930"></a>01930  v1 = v2 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)bdr.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01931"></a>01931  <span class="keywordflow">do</span>
<a name="l01932"></a>01932  {
<a name="l01933"></a>01933   bdrs.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v1);
<a name="l01934"></a>01934   v1 = v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa39f34a08953a1a6b7954852d4a5ea9d" title="Returns the vertex following this one on the boundary.">nextOnBoundary</a>();
<a name="l01935"></a>01935  } <span class="keywordflow">while</span> (v1 != v2);
<a name="l01936"></a>01936 
<a name="l01937"></a>01937  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>);
<a name="l01938"></a>01938  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l01939"></a>01939 
<a name="l01940"></a>01940  v1 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)bdrs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01941"></a>01941  v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v1);
<a name="l01942"></a>01942  <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v1);
<a name="l01943"></a>01943  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l01944"></a>01944 
<a name="l01945"></a>01945  <span class="keywordflow">for</span> (n = bdrs.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>(); n!=NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>())
<a name="l01946"></a>01946  {
<a name="l01947"></a>01947   v1 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01948"></a>01948   <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v1);
<a name="l01949"></a>01949   v2 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01950"></a>01950   e = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v1);
<a name="l01951"></a>01951   <a class="code" href="../../dc/d42/classTriangulation.html#ab0998076eb4399603c68310624f4094a" title="Creates a properly oriented Triangle bounded by three existing mesh edges.">CreateTriangle</a>(e, v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2), (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01952"></a>01952   <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l01953"></a>01953  }
<a name="l01954"></a>01954  <a class="code" href="../../dc/d42/classTriangulation.html#ae6106620e0853f98aded0112640dea4d" title="Creates a new Edge &#39;e&#39; and an oriented Triangle bounded by &#39;e&#39;, &#39;e1&#39; and &#39;e2&#39;.">EulerEdgeTriangle</a>(v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>, (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l01955"></a>01955 
<a name="l01956"></a>01956  <span class="keywordflow">return</span> v;
<a name="l01957"></a>01957 }
<a name="l01958"></a>01958 
<a name="l01959"></a>01959 
<a name="l01961"></a>01961 
<a name="l01962"></a><a class="code" href="../../dc/d42/classTriangulation.html#af62f787189c631ca1a8cd7115ded4e51">01962</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#af62f787189c631ca1a8cd7115ded4e51">Triangulation::retriangulateVT</a>(<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v)
<a name="l01963"></a>01963 {
<a name="l01964"></a>01964  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> nor;
<a name="l01965"></a>01965  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *e0 = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a387f90a0a9e849c2b283299e72055781" title="Triangle&#39;s edge opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the triangle.">oppositeEdge</a>(v);
<a name="l01966"></a>01966  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *vt = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#ab4e43fc6bf5eb192cd16cf8ac0bb544d" title="List of incident triangles.">VT</a>();
<a name="l01967"></a>01967  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> oe;
<a name="l01968"></a>01968  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l01969"></a>01969  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *m, *n;
<a name="l01970"></a>01970  <span class="keywordtype">int</span> i, nt;
<a name="l01971"></a>01971 
<a name="l01972"></a>01972  <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(vt, t, m)
<a name="l01973"></a>01973  {
<a name="l01974"></a>01974   e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a387f90a0a9e849c2b283299e72055781" title="Triangle&#39;s edge opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the triangle.">oppositeEdge</a>(v);
<a name="l01975"></a>01975   oe.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e));
<a name="l01976"></a>01976   oe.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(e);
<a name="l01977"></a>01977   oe.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e));
<a name="l01978"></a>01978   nor = nor+t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>();
<a name="l01979"></a>01979   <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(t);
<a name="l01980"></a>01980  }
<a name="l01981"></a>01981  nor.<a class="code" href="../../dc/d4f/classPoint.html#aef2212b0f31228e803ecbf389bfe7302" title="Divides the vector by its length. If isNull() the application exits with an error.">normalize</a>();
<a name="l01982"></a>01982  nt = <a class="code" href="../../dc/d42/classTriangulation.html#a777e577009b7e36cb1eb2d764979f2c6">TriangulateHole</a>(e0, &amp;nor);
<a name="l01983"></a>01983 
<a name="l01984"></a>01984  <span class="keywordflow">for</span> (m=<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(), i=0; i&lt;nt; i++, m=m-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>())
<a name="l01985"></a>01985  {
<a name="l01986"></a>01986   t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)m-&gt;data);
<a name="l01987"></a>01987   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a10a92c852553276b5871981e4bee4b" title="Return TRUE iff one of the adjacent triangles overlaps with this one.">overlaps</a>() || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>()) <span class="keywordflow">break</span>;
<a name="l01988"></a>01988  }
<a name="l01989"></a>01989  <span class="keywordflow">if</span> (i&lt;nt)
<a name="l01990"></a>01990  {
<a name="l01991"></a>01991   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Re-triangulation failed. Restoring..\n&quot;</span>);
<a name="l01992"></a>01992   <span class="keywordflow">for</span> (m=<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>(), i=0; i&lt;nt; i++, m=m-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>())
<a name="l01993"></a>01993    <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)m-&gt;data));
<a name="l01994"></a>01994   n = oe.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>();
<a name="l01995"></a>01995   <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(vt, t, m)
<a name="l01996"></a>01996   {
<a name="l01997"></a>01997    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>); n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l01998"></a>01998    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>); n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l01999"></a>01999    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>); n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>();
<a name="l02000"></a>02000    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = v; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL)?(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>):(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>);
<a name="l02001"></a>02001    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = v; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL)?(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>):(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>);
<a name="l02002"></a>02002    ((t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL)?(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>):(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)) = t;
<a name="l02003"></a>02003    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t;
<a name="l02004"></a>02004    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t;
<a name="l02005"></a>02005   }
<a name="l02006"></a>02006   v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)vt-&gt;<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>)-&gt;e1;
<a name="l02007"></a>02007  }
<a name="l02008"></a>02008  <span class="keyword">delete</span>(vt);
<a name="l02009"></a>02009 
<a name="l02010"></a>02010  <span class="keywordflow">return</span> 1;
<a name="l02011"></a>02011 }
<a name="l02012"></a>02012 
<a name="l02013"></a>02013 
<a name="l02015"></a>02015 
<a name="l02016"></a><a class="code" href="../../dc/d42/classTriangulation.html#a13f309a90aa39558bba62f10cab9d911">02016</a> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *<a class="code" href="../../dc/d42/classTriangulation.html#a13f309a90aa39558bba62f10cab9d911">Triangulation::splitEdge</a>(<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *p, <span class="keywordtype">bool</span> copy_mask)
<a name="l02017"></a>02017 {
<a name="l02018"></a>02018  <span class="keywordflow">if</span> ((*p)==(*(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>))) <span class="keywordflow">return</span> e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;
<a name="l02019"></a>02019  <span class="keywordflow">if</span> ((*p)==(*(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>))) <span class="keywordflow">return</span> e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>;
<a name="l02020"></a>02020  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v3 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)?(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(e)):(NULL);
<a name="l02021"></a>02021  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v4 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)?(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(e)):(NULL);
<a name="l02022"></a>02022  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *be1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)?(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)):(NULL);
<a name="l02023"></a>02023  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *be4 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)?(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e)):(NULL);
<a name="l02024"></a>02024  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>);
<a name="l02025"></a>02025  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>);
<a name="l02026"></a>02026  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)?(<span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v3)):(NULL);
<a name="l02027"></a>02027  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)?(<span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v4)):(NULL);
<a name="l02028"></a>02028  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *nt1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)?(<span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(ne1, ne,be1)):(NULL);
<a name="l02029"></a>02029  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *nt2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)?(<span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(ne, ne2,be4)):(NULL);
<a name="l02030"></a>02030 
<a name="l02031"></a>02031  ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = nt1; ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = nt2;
<a name="l02032"></a>02032  <span class="keywordflow">if</span> (ne1 != NULL) {ne1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>; ne1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = nt1;}
<a name="l02033"></a>02033  <span class="keywordflow">if</span> (ne2 != NULL) {ne2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = nt2; ne2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>;}
<a name="l02034"></a>02034  <span class="keywordflow">if</span> (be1 != NULL) be1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>, nt1);
<a name="l02035"></a>02035  <span class="keywordflow">if</span> (be4 != NULL) be4-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>, nt2);
<a name="l02036"></a>02036  e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = (be1 != NULL)?(be1):(be4);
<a name="l02037"></a>02037  e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = v;
<a name="l02038"></a>02038  v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l02039"></a>02039  <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(be1, ne1);
<a name="l02040"></a>02040  <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(be4, ne2);
<a name="l02041"></a>02041 
<a name="l02042"></a>02042  <span class="keywordflow">if</span> (copy_mask)
<a name="l02043"></a>02043  {
<a name="l02044"></a>02044   ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a>;
<a name="l02045"></a>02045   <span class="keywordflow">if</span> (nt1 != NULL) nt1-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>;
<a name="l02046"></a>02046   <span class="keywordflow">if</span> (nt2 != NULL) nt2-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>;
<a name="l02047"></a>02047  }
<a name="l02048"></a>02048 
<a name="l02049"></a>02049  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l02050"></a>02050  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne);
<a name="l02051"></a>02051  <span class="keywordflow">if</span> (ne1 != NULL) <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne1);
<a name="l02052"></a>02052  <span class="keywordflow">if</span> (ne2 != NULL) <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne2);
<a name="l02053"></a>02053  <span class="keywordflow">if</span> (nt1 != NULL) <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nt1);
<a name="l02054"></a>02054  <span class="keywordflow">if</span> (nt2 != NULL) <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nt2);
<a name="l02055"></a>02055 
<a name="l02056"></a>02056  <span class="keywordflow">return</span> v;
<a name="l02057"></a>02057 }
<a name="l02058"></a>02058 
<a name="l02059"></a>02059 
<a name="l02063"></a>02063 
<a name="l02064"></a><a class="code" href="../../dc/d42/classTriangulation.html#ac2da805322c62ca6092c082327636443">02064</a> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *<a class="code" href="../../dc/d42/classTriangulation.html#ac2da805322c62ca6092c082327636443">Triangulation::splitTriangle</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> *p, <span class="keywordtype">bool</span> only_proper)
<a name="l02065"></a>02065 {
<a name="l02066"></a>02066  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>();
<a name="l02067"></a>02067  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>();
<a name="l02068"></a>02068  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();
<a name="l02069"></a>02069 
<a name="l02070"></a>02070  <span class="keywordflow">if</span> ((*p) == (*v1)) <span class="keywordflow">return</span> (only_proper)?(NULL):v1;
<a name="l02071"></a>02071  <span class="keywordflow">if</span> ((*p) == (*v2)) <span class="keywordflow">return</span> (only_proper)?(NULL):v2;
<a name="l02072"></a>02072  <span class="keywordflow">if</span> ((*p) == (*v3)) <span class="keywordflow">return</span> (only_proper)?(NULL):v3;
<a name="l02073"></a>02073  <span class="keywordflow">if</span> (!only_proper)
<a name="l02074"></a>02074  {
<a name="l02075"></a>02075   <span class="keywordflow">if</span> (p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a52d0b7be4253acd254d5a615b9ba8289">getAngle</a>(v1,v2) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) <span class="keywordflow">return</span> <a class="code" href="../../dc/d42/classTriangulation.html#a13f309a90aa39558bba62f10cab9d911">splitEdge</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>, p);
<a name="l02076"></a>02076   <span class="keywordflow">if</span> (p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a52d0b7be4253acd254d5a615b9ba8289">getAngle</a>(v2,v3) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) <span class="keywordflow">return</span> <a class="code" href="../../dc/d42/classTriangulation.html#a13f309a90aa39558bba62f10cab9d911">splitEdge</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>, p);
<a name="l02077"></a>02077   <span class="keywordflow">if</span> (p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#a52d0b7be4253acd254d5a615b9ba8289">getAngle</a>(v3,v1) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) <span class="keywordflow">return</span> <a class="code" href="../../dc/d42/classTriangulation.html#a13f309a90aa39558bba62f10cab9d911">splitEdge</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, p);
<a name="l02078"></a>02078  }
<a name="l02079"></a>02079 
<a name="l02080"></a>02080  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#af82eb022862441555135e5a53145c150">x</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#aae4ead6861dba21fd2af2909e9d7d6cf">y</a>, p-&gt;<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a>);
<a name="l02081"></a>02081  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne1 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v1);
<a name="l02082"></a>02082  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne2 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v2);
<a name="l02083"></a>02083  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne3 = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(v, v3);
<a name="l02084"></a>02084  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *nt1 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(ne2, t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>,ne3);
<a name="l02085"></a>02085  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *nt2 = <span class="keyword">new</span> <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a>(ne3, t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>,ne1);
<a name="l02086"></a>02086  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(t, nt1);
<a name="l02087"></a>02087  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a202f46fc3cf83b02de34e6861f698856" title="Replace incident triangle &#39;a&#39; with &#39;b&#39; and return TRUE. If &#39;a&#39; is not incident to the edge return FAL...">replaceTriangle</a>(t, nt2);
<a name="l02088"></a>02088  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>, ne2);
<a name="l02089"></a>02089  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>, ne1);
<a name="l02090"></a>02090  ne1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = t; ne1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = nt2;
<a name="l02091"></a>02091  ne2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = nt1; ne2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = t;
<a name="l02092"></a>02092  ne3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> = nt2; ne3-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = nt1;
<a name="l02093"></a>02093  v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = ne1;
<a name="l02094"></a>02094 
<a name="l02095"></a>02095  <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v);
<a name="l02096"></a>02096  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne1);
<a name="l02097"></a>02097  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne2);
<a name="l02098"></a>02098  <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne3);
<a name="l02099"></a>02099  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nt1);
<a name="l02100"></a>02100  <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(nt2);
<a name="l02101"></a>02101 
<a name="l02102"></a>02102  <span class="keywordflow">return</span> v;
<a name="l02103"></a>02103 }
<a name="l02104"></a>02104 
<a name="l02105"></a>02105 
<a name="l02107"></a>02107 <span class="comment">//                                                              //</span>
<a name="l02108"></a>02108 <span class="comment">//    D E B U G   AND WORK-IN-PROGRESS                          //</span>
<a name="l02109"></a>02109 <span class="comment">//                                                              //</span>
<a name="l02111"></a>02111 <span class="comment"></span>
<a name="l02112"></a>02112 
<a name="l02114"></a>02114 
<a name="l02115"></a><a class="code" href="../../dc/d42/classTriangulation.html#aa1f7a61a81d98fd2fd43c97a0dbc2b45">02115</a> <span class="keywordtype">void</span> <a class="code" href="../../dc/d42/classTriangulation.html#aa1f7a61a81d98fd2fd43c97a0dbc2b45">Triangulation::printReport</a>()
<a name="l02116"></a>02116 {
<a name="l02117"></a>02117  <a class="code" href="../../dc/d42/classTriangulation.html#ab9694f134bbc51c81b8dfe675fa8ecd4" title="Updates the values of n_boundaries, n_handles and n_shells. O(N).">eulerUpdate</a>();
<a name="l02118"></a>02118 
<a name="l02119"></a>02119  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;*** Triangulation Report ***\n&quot;</span>);
<a name="l02120"></a>02120  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;V: %d\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>());
<a name="l02121"></a>02121  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;E: %d\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>());
<a name="l02122"></a>02122  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;T: %d\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>());
<a name="l02123"></a>02123 
<a name="l02124"></a>02124  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;Boundary: %d components.\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#a6a4076a70a0d214f472e92a298eeb03c" title="Get the number of boundary loops of the triangle mesh. O(1) or O(N).">boundaries</a>());
<a name="l02125"></a>02125  JMesh::info(<span class="stringliteral">&quot;Handles: %d.\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#a0e75501a03e2f163f5eefc2d2d7099e0" title="Get the number of handles of the triangle mesh. O(1) or O(N).">handles</a>());
<a name="l02126"></a>02126  JMesh::info(<span class="stringliteral">&quot;Shells: %d.\n&quot;</span>,<a class="code" href="../../dc/d42/classTriangulation.html#af06a73bd1d73fea08bd6893f9b253ba5" title="Get the number of connected components of the triangle mesh. O(1) or O(N).">shells</a>());
<a name="l02127"></a>02127 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dd/da9/tin_8cpp.html">tin.cpp</a>      </li>
      <li class="footer">Generated on Mon Feb 4 2013 11:36:19 for OpenCog Framework by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
