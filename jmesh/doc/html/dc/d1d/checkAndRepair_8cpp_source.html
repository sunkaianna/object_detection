<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenCog Framework: /home/wondereamer/object_detection/JMeshLib-1.2/src/MESH_STRUCTURE/checkAndRepair.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = '../../open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = '../../closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCog Framework&#160;<span id="projectnumber">Branch: opencog, revision 7348</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dc/d1d/checkAndRepair_8cpp.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">checkAndRepair.cpp</div>  </div>
</div>
<div class="contents">
<a href="../../dc/d1d/checkAndRepair_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* JMeshLib                                                                  *</span>
<a name="l00003"></a>00003 <span class="comment">*                                                                           *</span>
<a name="l00004"></a>00004 <span class="comment">* Consiglio Nazionale delle Ricerche                                        *</span>
<a name="l00005"></a>00005 <span class="comment">* Istituto di Matematica Applicata e Tecnologie Informatiche                *</span>
<a name="l00006"></a>00006 <span class="comment">* Sezione di Genova                                                         *</span>
<a name="l00007"></a>00007 <span class="comment">* IMATI-GE / CNR                                                            *</span>
<a name="l00008"></a>00008 <span class="comment">*                                                                           *</span>
<a name="l00009"></a>00009 <span class="comment">* Authors: Marco Attene                                                     *</span>
<a name="l00010"></a>00010 <span class="comment">*                                                                           *</span>
<a name="l00011"></a>00011 <span class="comment">* Copyright(C) 2006: IMATI-GE / CNR                                         *</span>
<a name="l00012"></a>00012 <span class="comment">*                                                                           *</span>
<a name="l00013"></a>00013 <span class="comment">* All rights reserved.                                                      *</span>
<a name="l00014"></a>00014 <span class="comment">*                                                                           *</span>
<a name="l00015"></a>00015 <span class="comment">* This program is free software; you can redistribute it and/or modify      *</span>
<a name="l00016"></a>00016 <span class="comment">* it under the terms of the GNU General Public License as published by      *</span>
<a name="l00017"></a>00017 <span class="comment">* the Free Software Foundation; either version 2 of the License, or         *</span>
<a name="l00018"></a>00018 <span class="comment">* (at your option) any later version.                                       *</span>
<a name="l00019"></a>00019 <span class="comment">*                                                                           *</span>
<a name="l00020"></a>00020 <span class="comment">* This program is distributed in the hope that it will be useful,           *</span>
<a name="l00021"></a>00021 <span class="comment">* but WITHOUT ANY WARRANTY; without even the implied warranty of            *</span>
<a name="l00022"></a>00022 <span class="comment">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the             *</span>
<a name="l00023"></a>00023 <span class="comment">* GNU General Public License (http://www.gnu.org/licenses/gpl.txt)          *</span>
<a name="l00024"></a>00024 <span class="comment">* for more details.                                                         *</span>
<a name="l00025"></a>00025 <span class="comment">*                                                                           *</span>
<a name="l00026"></a>00026 <span class="comment">****************************************************************************/</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="../../d2/dde/jmesh_8h.html">jmesh.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/d9c/jqsort_8h.html" title="Declaration of a generic QuickSort function.">jqsort.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="../../dc/d42/classTriangulation.html#a07df98c37a8fc0b2cda085cb098e12e0">00036</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a07df98c37a8fc0b2cda085cb098e12e0">Triangulation::checkAndRepair</a>()
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d42/classTriangulation.html#afe57f115e3fad9e9ecf92134c779d416">mergeCoincidentEdges</a>()) <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Some coincident edges have been merged.\n&quot;</span>);
<a name="l00039"></a>00039  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d42/classTriangulation.html#aab365ba8f1e9eaecddb8272d287617a8">removeDegenerateTriangles</a>()) <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Some edges have been swapped or collapsed to eliminate degenerate triangles.\n&quot;</span>);
<a name="l00040"></a>00040 
<a name="l00041"></a>00041  <a class="code" href="../../dc/d42/classTriangulation.html#aa1f7a61a81d98fd2fd43c97a0dbc2b45">printReport</a>();
<a name="l00042"></a>00042 
<a name="l00043"></a>00043  <span class="keywordflow">return</span> 1;
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00047"></a>00047 <span class="comment">//</span>
<a name="l00048"></a>00048 <span class="comment">// This method should be used when implementing new algorithms to</span>
<a name="l00049"></a>00049 <span class="comment">// check the consistency of the connectivity graph. Because an</span>
<a name="l00050"></a>00050 <span class="comment">// inconsistent graph is not assumed by all the other methods, such</span>
<a name="l00051"></a>00051 <span class="comment">// a flaw is considered critical and the program should terminate.</span>
<a name="l00052"></a>00052 <span class="comment">// If connectivity is ok, NULL is returned, otherwise a string</span>
<a name="l00053"></a>00053 <span class="comment">// describing the error is returned.</span>
<a name="l00054"></a>00054 <span class="comment">//</span>
<a name="l00056"></a>00056 <span class="comment"></span>
<a name="l00057"></a><a class="code" href="../../dc/d42/classTriangulation.html#a86ef5d6dc2a592fa6cbfbdd4a9810bd1">00057</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d42/classTriangulation.html#a86ef5d6dc2a592fa6cbfbdd4a9810bd1">Triangulation::checkConnectivity</a>()
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l00060"></a>00060  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e,*e2;
<a name="l00061"></a>00061  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00062"></a>00062  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n,*m;
<a name="l00063"></a>00063  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n)
<a name="l00066"></a>00066  {
<a name="l00067"></a>00067   <span class="keywordflow">if</span> (v == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected NULL element in V list!&quot;</span>;
<a name="l00068"></a>00068   <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected NULL e0 pointer for a vertex!&quot;</span>;
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a63613c87061cd892d2cb135651b8f492" title="TRUE iff &#39;v&#39; is an end-point of the edge.">hasVertex</a>(v)) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected wrong e0 pointer for a vertex!&quot;</span>;
<a name="l00070"></a>00070  }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00073"></a>00073  {
<a name="l00074"></a>00074   <span class="keywordflow">if</span> (e == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected NULL element in E list!&quot;</span>;
<a name="l00075"></a>00075   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> == NULL || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected edge with one or two NULL end-points!&quot;</span>;
<a name="l00076"></a>00076   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected edge with two coincident end-points!&quot;</span>;
<a name="l00077"></a>00077   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected edge with no incident triangles!&quot;</span>;
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)
<a name="l00079"></a>00079   {
<a name="l00080"></a>00080    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aad4ea1f720054c3ff1c0b1cdd32d7b11" title="TRUE iff &#39;e&#39; is an edge of the triangle.">hasEdge</a>(e)) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected wrong t1 triangle at an edge&quot;</span>;
<a name="l00081"></a>00081    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)
<a name="l00082"></a>00082     <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: Edge orientation does not match t1 normal&quot;</span>;
<a name="l00083"></a>00083   }
<a name="l00084"></a>00084   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)
<a name="l00085"></a>00085   {
<a name="l00086"></a>00086    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aad4ea1f720054c3ff1c0b1cdd32d7b11" title="TRUE iff &#39;e&#39; is an edge of the triangle.">hasEdge</a>(e)) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected wrong t2 triangle at an edge&quot;</span>;
<a name="l00087"></a>00087    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)
<a name="l00088"></a>00088     <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: Edge orientation does not match t2 normal&quot;</span>;
<a name="l00089"></a>00089   }
<a name="l00090"></a>00090  }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n)
<a name="l00093"></a>00093  {
<a name="l00094"></a>00094   <span class="keywordflow">if</span> (t == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected NULL element in T list!&quot;</span>;
<a name="l00095"></a>00095   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected NULL as a triangle edge!&quot;</span>;
<a name="l00096"></a>00096   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> == t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> == t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> == t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected triangle with two coincident edges!&quot;</span>;
<a name="l00097"></a>00097   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>() == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>() == NULL || t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>() == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: triangle edges do not share vertices!&quot;</span>;
<a name="l00098"></a>00098   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != t &amp;&amp; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != t) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected triangle with 1st edge not pointing to the triangle itself!&quot;</span>;
<a name="l00099"></a>00099   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != t &amp;&amp; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != t) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected triangle with 2nd edge not pointing to the triangle itself!&quot;</span>;
<a name="l00100"></a>00100   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != t &amp;&amp; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != t) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected triangle with 3rd edge not pointing to the triangle itself!&quot;</span>;
<a name="l00101"></a>00101  }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00104"></a>00104  {
<a name="l00105"></a>00105   ve = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00106"></a>00106   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e2, m)
<a name="l00107"></a>00107   {
<a name="l00108"></a>00108    <span class="keywordflow">if</span> (e2 != e &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected duplicate edge!&quot;</span>;
<a name="l00109"></a>00109   }
<a name="l00110"></a>00110   <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#a39fdb8f5c7f4feae8e53bc74646f1248" title="Returns the node storing &#39;d&#39;. NULL if not found.   O(numels()).">containsNode</a>(e) == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected non manifold vertex!&quot;</span>;
<a name="l00111"></a>00111   <span class="keyword">delete</span>(ve);
<a name="l00112"></a>00112   ve = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00113"></a>00113   <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, e2, m)
<a name="l00114"></a>00114   {
<a name="l00115"></a>00115    <span class="keywordflow">if</span> (e2 != e &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected duplicate edge!&quot;</span>;
<a name="l00116"></a>00116   }
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#a39fdb8f5c7f4feae8e53bc74646f1248" title="Returns the node storing &#39;d&#39;. NULL if not found.   O(numels()).">containsNode</a>(e) == NULL) <span class="keywordflow">return</span> <span class="stringliteral">&quot;checkConnectivity: detected non manifold vertex!&quot;</span>;
<a name="l00118"></a>00118   <span class="keyword">delete</span>(ve);
<a name="l00119"></a>00119  }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121  <span class="keywordflow">return</span> NULL;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 
<a name="l00126"></a>00126 <span class="comment">//</span>
<a name="l00127"></a>00127 <span class="comment">// If a vertex is topologically non-manifold, this data structure</span>
<a name="l00128"></a>00128 <span class="comment">// does not guarantee its functionality. Therefore, in order to use</span>
<a name="l00129"></a>00129 <span class="comment">// the same triangle mesh, this method allows to duplicate such</span>
<a name="l00130"></a>00130 <span class="comment">// vertices. Notice that the data-structure cannot code non-manifold</span>
<a name="l00131"></a>00131 <span class="comment">// edges.</span>
<a name="l00132"></a>00132 <span class="comment">//</span>
<a name="l00134"></a>00134 <span class="comment"></span>
<a name="l00135"></a><a class="code" href="../../dc/d42/classTriangulation.html#a42e3d87b90251c958abe310830303ac5">00135</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a42e3d87b90251c958abe310830303ac5">Triangulation::duplicateNonManifoldVertices</a>()
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v;
<a name="l00138"></a>00138  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *f;
<a name="l00139"></a>00139  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n, *m;
<a name="l00140"></a>00140  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *ve;
<a name="l00141"></a>00141  <span class="keywordtype">int</span> dv = 0;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00144"></a>00144  {
<a name="l00145"></a>00145   ve = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00146"></a>00146   <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#a39fdb8f5c7f4feae8e53bc74646f1248" title="Returns the node storing &#39;d&#39;. NULL if not found.   O(numels()).">containsNode</a>(e) == NULL)
<a name="l00147"></a>00147   {
<a name="l00148"></a>00148    <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>));
<a name="l00149"></a>00149    <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, f, m) f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a1fd6aa6d0b8435d0087625f695e0be18" title="Replace vertex &#39;a&#39; with vertex &#39;b&#39; in the edge and return TRUE. If &#39;a&#39; is not a vertex of the edge re...">replaceVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>, v);
<a name="l00150"></a>00150    v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>;
<a name="l00151"></a>00151    e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00152"></a>00152    dv++;
<a name="l00153"></a>00153   }
<a name="l00154"></a>00154   <span class="keyword">delete</span>(ve);
<a name="l00155"></a>00155  }
<a name="l00156"></a>00156  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00157"></a>00157  {
<a name="l00158"></a>00158   ve = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a7e8c43c6cd55a237d2f5b6373000a9fc" title="List of incident edges.">VE</a>();
<a name="l00159"></a>00159   <span class="keywordflow">if</span> (ve-&gt;<a class="code" href="../../d6/da9/classList.html#a39fdb8f5c7f4feae8e53bc74646f1248" title="Returns the node storing &#39;d&#39;. NULL if not found.   O(numels()).">containsNode</a>(e) == NULL)
<a name="l00160"></a>00160   {
<a name="l00161"></a>00161    <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(v = <span class="keyword">new</span> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>));
<a name="l00162"></a>00162    <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>(ve, f, m) f-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a1fd6aa6d0b8435d0087625f695e0be18" title="Replace vertex &#39;a&#39; with vertex &#39;b&#39; in the edge and return TRUE. If &#39;a&#39; is not a vertex of the edge re...">replaceVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, v);
<a name="l00163"></a>00163    v-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a>;
<a name="l00164"></a>00164    e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = e;
<a name="l00165"></a>00165    dv++;
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167   <span class="keyword">delete</span>(ve);
<a name="l00168"></a>00168  }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170  <span class="keywordflow">if</span> (dv) <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172  <span class="keywordflow">return</span> dv;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="../../dc/d42/classTriangulation.html#acec74b744af17b41e6de902fbe4163b6">00183</a> <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *<a class="code" href="../../dc/d42/classTriangulation.html#acec74b744af17b41e6de902fbe4163b6">Triangulation::checkGeometry</a>()
<a name="l00184"></a>00184 {
<a name="l00185"></a>00185  <span class="keywordtype">int</span> i;
<a name="l00186"></a>00186  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *ret = NULL;
<a name="l00187"></a>00187  <span class="keywordtype">double</span> ang, minda = 0;
<a name="l00188"></a>00188  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00189"></a>00189  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00190"></a>00190  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> **varr = (<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> **)<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#a639070d48fa0e2ba4949d681a5a538e8" title="Creates an array out of the list.   O(numels()).">toArray</a>();
<a name="l00191"></a>00191  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> **evarr;
<a name="l00192"></a>00192  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v1, *v2;
<a name="l00193"></a>00193  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195  <span class="keywordflow">if</span> (varr == NULL) <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: Not enough memory. Can&#39;t check for coincident vertices.\n&quot;</span>);
<a name="l00196"></a>00196  <span class="keywordflow">else</span>
<a name="l00197"></a>00197  {
<a name="l00198"></a>00198   <a class="code" href="../../d4/d9c/jqsort_8h.html#a0e0a5046ed4b995bf879d4701347df74">jqsort</a>((<span class="keywordtype">void</span> **)varr, <a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>(), <a class="code" href="../../d2/d91/point_8h.html#a03cdc50fe0228d7e864e3876653850f3" title="Lexycographic comparison to be used with jqsort() or abstractHeap.">xyzCompare</a>);
<a name="l00199"></a>00199   <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../dc/d42/classTriangulation.html#a8fc66ebfab595d2ebdbc182b925c995d" title="Vertex set.">V</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()-1); i++)
<a name="l00200"></a>00200   {
<a name="l00201"></a>00201    v1 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)varr[i]);
<a name="l00202"></a>00202    v2 = ((<a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *)varr[i+1]);
<a name="l00203"></a>00203    <span class="keywordflow">if</span> ((*v1)==(*v2))
<a name="l00204"></a>00204    {
<a name="l00205"></a>00205     ret = v1;
<a name="l00206"></a>00206     <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: detected coincident vertices.\n&quot;</span>);
<a name="l00207"></a>00207     <span class="keywordflow">if</span> (v1-&gt;<a class="code" href="../../d2/da0/classVertex.html#acfe8029993aaa98ad126ddb652960cf0" title="Returns the edge connecting this vertex to &#39;v&#39;. NULL if such an edge does not exist.">getEdge</a>(v2))
<a name="l00208"></a>00208     {
<a name="l00209"></a>00209      <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;               and there is an edge connecting them!\n&quot;</span>);
<a name="l00210"></a>00210      free(varr);
<a name="l00211"></a>00211      <span class="keywordflow">return</span> v1;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213    }
<a name="l00214"></a>00214   }
<a name="l00215"></a>00215   free(varr);
<a name="l00216"></a>00216  }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218  evarr = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> **)<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a639070d48fa0e2ba4949d681a5a538e8" title="Creates an array out of the list.   O(numels()).">toArray</a>();
<a name="l00219"></a>00219  <span class="keywordflow">if</span> (evarr == NULL) <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: Not enough memory. Can&#39;t check for coincident edges.\n&quot;</span>);
<a name="l00220"></a>00220  <span class="keywordflow">else</span>
<a name="l00221"></a>00221  {
<a name="l00222"></a>00222   <a class="code" href="../../d4/d9c/jqsort_8h.html#a0e0a5046ed4b995bf879d4701347df74">jqsort</a>((<span class="keywordtype">void</span> **)evarr, <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>(), <a class="code" href="../../db/dc3/edge_8h.html#abc9e4a3f2faf76b04f6cb47dff211961" title="Lexycographic edge comparison to be used with jqsort() or abstractHeap.">lexEdgeCompare</a>);
<a name="l00223"></a>00223   <span class="keywordflow">for</span> (i=0; i&lt;(<a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()-1); i++)
<a name="l00224"></a>00224   {
<a name="l00225"></a>00225    <span class="keywordflow">if</span> (!<a class="code" href="../../db/dc3/edge_8h.html#abc9e4a3f2faf76b04f6cb47dff211961" title="Lexycographic edge comparison to be used with jqsort() or abstractHeap.">lexEdgeCompare</a>(evarr[i], evarr[i+1]))
<a name="l00226"></a>00226    {
<a name="l00227"></a>00227     ret = ((<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)evarr[i])-&gt;v1;
<a name="l00228"></a>00228     <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: detected coincident edges.\n&quot;</span>);
<a name="l00229"></a>00229    }
<a name="l00230"></a>00230   }
<a name="l00231"></a>00231   free(evarr);
<a name="l00232"></a>00232  }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n)
<a name="l00235"></a>00235  {
<a name="l00236"></a>00236   ang = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a51f936888c1d9d7d6759ee9a366426d8" title="Angle at vertex &#39;v&#39;. Return -1 if &#39;v&#39; is not a vertex of the triangle.">getAngle</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>());
<a name="l00237"></a>00237   <span class="keywordflow">if</span> (ang == 0 || ang == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: degenerate triangle detected.\n&quot;</span>); <span class="keywordflow">return</span> t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>();}
<a name="l00238"></a>00238   ang = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a51f936888c1d9d7d6759ee9a366426d8" title="Angle at vertex &#39;v&#39;. Return -1 if &#39;v&#39; is not a vertex of the triangle.">getAngle</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>());
<a name="l00239"></a>00239   <span class="keywordflow">if</span> (ang == 0 || ang == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: degenerate triangle detected.\n&quot;</span>); <span class="keywordflow">return</span> t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>();}
<a name="l00240"></a>00240   ang = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a51f936888c1d9d7d6759ee9a366426d8" title="Angle at vertex &#39;v&#39;. Return -1 if &#39;v&#39; is not a vertex of the triangle.">getAngle</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>());
<a name="l00241"></a>00241   <span class="keywordflow">if</span> (ang == 0 || ang == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: degenerate triangle detected.\n&quot;</span>); <span class="keywordflow">return</span> t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>();}
<a name="l00242"></a>00242  }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244  ang = minda = 0;
<a name="l00245"></a>00245  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00246"></a>00246   <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL &amp;&amp; (ang = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>)
<a name="l00247"></a>00247    {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;checkGeometry: overlapping triangles detected.\n&quot;</span>); <span class="keywordflow">return</span> e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>;}
<a name="l00248"></a>00248   <span class="keywordflow">else</span> minda = <a class="code" href="../../d3/da2/j__mesh_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(minda,ang);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;checkGeometry: minimum dihedral angle = %f (%f DEGs)\n&quot;</span>, <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>-minda, ((<a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>-minda)*360)/(2*<a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>));
<a name="l00251"></a>00251 
<a name="l00252"></a>00252  <span class="keywordflow">return</span> ret;
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 
<a name="l00257"></a>00257 
<a name="l00258"></a><a class="code" href="../../dc/d42/classTriangulation.html#afe57f115e3fad9e9ecf92134c779d416">00258</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#afe57f115e3fad9e9ecf92134c779d416">Triangulation::mergeCoincidentEdges</a>()
<a name="l00259"></a>00259 {
<a name="l00260"></a>00260  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> bes;
<a name="l00261"></a>00261  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00262"></a>00262  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e1, *e2;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e1, n) <span class="keywordflow">if</span> (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) bes.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e1);
<a name="l00265"></a>00265  <span class="keywordflow">if</span> (!bes.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()) <span class="keywordflow">return</span> 0;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> **evarr = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> **)bes.<a class="code" href="../../d6/da9/classList.html#a639070d48fa0e2ba4949d681a5a538e8" title="Creates an array out of the list.   O(numels()).">toArray</a>();
<a name="l00268"></a>00268  <span class="keywordtype">int</span> i, ret = 0, wrn = 0;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270  <a class="code" href="../../d4/d9c/jqsort_8h.html#a0e0a5046ed4b995bf879d4701347df74">jqsort</a>((<span class="keywordtype">void</span> **)evarr, bes.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>(), <a class="code" href="../../db/dc3/edge_8h.html#abc9e4a3f2faf76b04f6cb47dff211961" title="Lexycographic edge comparison to be used with jqsort() or abstractHeap.">lexEdgeCompare</a>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272   <span class="keywordflow">for</span> (i=0; i&lt;(bes.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>()-1); i++)
<a name="l00273"></a>00273   {
<a name="l00274"></a>00274    e1 = evarr[i];
<a name="l00275"></a>00275    e2 = evarr[i+1];
<a name="l00276"></a>00276    <span class="keywordflow">if</span> (!e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af289e2ee74d8adf16975e806ce3620e0" title="TRUE iff edge is properly linked to a Triangulation.">isLinked</a>()) evarr[i+1]=e1;
<a name="l00277"></a>00277    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../db/dc3/edge_8h.html#abc9e4a3f2faf76b04f6cb47dff211961" title="Lexycographic edge comparison to be used with jqsort() or abstractHeap.">lexEdgeCompare</a>(e1, e2) &amp;&amp;
<a name="l00278"></a>00278             (
<a name="l00279"></a>00279              (((*(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>))==(*(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>))) &amp;&amp; ((e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) || (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>))) ||
<a name="l00280"></a>00280              (((*(e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>))==(*(e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>))) &amp;&amp; ((e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>) || (e1-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> &amp;&amp; e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)))
<a name="l00281"></a>00281             )
<a name="l00282"></a>00282            )
<a name="l00283"></a>00283            {
<a name="l00284"></a>00284             <span class="keywordflow">if</span> (!e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a9a16c300b9ce110b5bf49b5c35295699" title="Merge with another boundary edge.">merge</a>(e1)) wrn++;
<a name="l00285"></a>00285             <span class="keywordflow">else</span>
<a name="l00286"></a>00286             {
<a name="l00287"></a>00287              ret += e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a0d9ca6b027ce5175c281256310c36db0" title="Zips the gap starting from here.">zip</a>();
<a name="l00288"></a>00288              ret += e2-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#a0d9ca6b027ce5175c281256310c36db0" title="Zips the gap starting from here.">zip</a>();
<a name="l00289"></a>00289             }
<a name="l00290"></a>00290            }
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293  free(evarr);
<a name="l00294"></a>00294  <a class="code" href="../../dc/d42/classTriangulation.html#ad8bdc6989d15950a95ad6a7dd217a0aa" title="Removes all the unlinked edges from List E. Returns the number of removed edges. O(N).">removeEdges</a>();
<a name="l00295"></a>00295  <a class="code" href="../../dc/d42/classTriangulation.html#a88faaa85a54d3999157d13b2775a1a8e" title="Removes all the unlinked vertices from List V. Returns the number of removed vertices. O(N).">removeVertices</a>();
<a name="l00296"></a>00296 
<a name="l00297"></a>00297  <span class="keywordflow">if</span> (wrn) <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;mergeCoincidentEdges: Couldn&#39;t merge unconsistently oriented edges.\n&quot;</span>);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299  <span class="keywordflow">if</span> (ret) <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301  <span class="keywordflow">return</span> ret;
<a name="l00302"></a>00302 }
<a name="l00303"></a>00303 
<a name="l00304"></a>00304 
<a name="l00306"></a>00306 
<a name="l00307"></a><a class="code" href="../../dc/d42/classTriangulation.html#a5e14a177ca24af3188183293ec47c00a">00307</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a5e14a177ca24af3188183293ec47c00a">Triangulation::removeDuplicatedTriangles</a>()
<a name="l00308"></a>00308 {
<a name="l00309"></a>00309  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00310"></a>00310  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00311"></a>00311  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> p;
<a name="l00312"></a>00312  <span class="keywordtype">int</span> i=0;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00315"></a>00315   <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(e) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(e))
<a name="l00316"></a>00316   {
<a name="l00317"></a>00317    p = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a75ccdf1d5198ab4fadd20e37af746ec8" title="Return the triangle&#39;s barycenter.">getCenter</a>();
<a name="l00318"></a>00318    <a class="code" href="../../dc/d42/classTriangulation.html#ac2da805322c62ca6092c082327636443">splitTriangle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>, &amp;p, 1);
<a name="l00319"></a>00319    i++;
<a name="l00320"></a>00320   }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322  <span class="keywordflow">if</span> (i)  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324  <span class="keywordflow">return</span> i;
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="../../dc/d42/classTriangulation.html#aab365ba8f1e9eaecddb8272d287617a8">00330</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#aab365ba8f1e9eaecddb8272d287617a8">Triangulation::removeDegenerateTriangles</a>()
<a name="l00331"></a>00331 {
<a name="l00332"></a>00332  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00333"></a>00333  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00334"></a>00334  <span class="keywordtype">int</span> collapses, swaps, degn, tcs = 0;
<a name="l00335"></a>00335  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo, *vt;
<a name="l00336"></a>00336  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00337"></a>00337 <span class="keywordtype">int</span> i=0;
<a name="l00338"></a>00338  <span class="keywordflow">do</span>
<a name="l00339"></a>00339  {
<a name="l00340"></a>00340   collapses = swaps = 0;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>())
<a name="l00343"></a>00343    {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);}
<a name="l00344"></a>00344 
<a name="l00345"></a>00345   <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00346"></a>00346   {
<a name="l00347"></a>00347 i++;
<a name="l00348"></a>00348    t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>();
<a name="l00349"></a>00349    <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00350"></a>00350    <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac46731347435712af4cf7015743a642b" title="TRUE if properly linked.">isLinked</a>())
<a name="l00351"></a>00351    {
<a name="l00352"></a>00352     <span class="keywordflow">if</span> ((e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a3ee0e02ba8880e40aea8ee3f2ffa3a0e" title="Cap-like degeneracy check.">isCap</a>()) != NULL)
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354      <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) {<a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(t); collapses++;}
<a name="l00355"></a>00355      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>())
<a name="l00356"></a>00356      {
<a name="l00357"></a>00357       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a10a92c852553276b5871981e4bee4b" title="Return TRUE iff one of the adjacent triangles overlaps with this one.">overlaps</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a10a92c852553276b5871981e4bee4b" title="Return TRUE iff one of the adjacent triangles overlaps with this one.">overlaps</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a3ee0e02ba8880e40aea8ee3f2ffa3a0e" title="Cap-like degeneracy check.">isCap</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a3ee0e02ba8880e40aea8ee3f2ffa3a0e" title="Cap-like degeneracy check.">isCap</a>()) e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1);
<a name="l00358"></a>00358       <span class="keywordflow">else</span>
<a name="l00359"></a>00359       {
<a name="l00360"></a>00360        swaps++;
<a name="l00361"></a>00361        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>); todo.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);}
<a name="l00362"></a>00362        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>); todo.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);}
<a name="l00363"></a>00363       }
<a name="l00364"></a>00364      }
<a name="l00365"></a>00365     }
<a name="l00366"></a>00366     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((e = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad0ceabf8a4ee4875a29e387ebe625ed3" title="Needle-like degeneracy check.">isNeedle</a>()) != NULL)
<a name="l00367"></a>00367     {
<a name="l00368"></a>00368      vt = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#ab4e43fc6bf5eb192cd16cf8ac0bb544d" title="List of incident triangles.">VT</a>();
<a name="l00369"></a>00369      <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a06c96950a914fe03c7b7e133d984b3df" title="Edge collapse.">collapse</a>())
<a name="l00370"></a>00370      {
<a name="l00371"></a>00371       collapses++;
<a name="l00372"></a>00372       <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(vt, t, n)
<a name="l00373"></a>00373        <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac46731347435712af4cf7015743a642b" title="TRUE if properly linked.">isLinked</a>() &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t); todo.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(t);}
<a name="l00374"></a>00374      }
<a name="l00375"></a>00375      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5c88747d474460c5a40886088ace4afb" title="Incident triangle opposite to &#39;t&#39;. NULL if &#39;t&#39; is not incident to the edge.">oppositeTriangle</a>(t)-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(e)-&gt;<a class="code" href="../../d2/da0/classVertex.html#ab6afdd17dd0ed462fb0a89bd71bef3d4" title="Returns the number of incident edges.">valence</a>() == 3)
<a name="l00376"></a>00376      {
<a name="l00377"></a>00377       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5c88747d474460c5a40886088ace4afb" title="Incident triangle opposite to &#39;t&#39;. NULL if &#39;t&#39; is not incident to the edge.">oppositeTriangle</a>(t)-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a06c96950a914fe03c7b7e133d984b3df" title="Edge collapse.">collapse</a>())
<a name="l00378"></a>00378       {
<a name="l00379"></a>00379        <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t); todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00380"></a>00380        t = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5c88747d474460c5a40886088ace4afb" title="Incident triangle opposite to &#39;t&#39;. NULL if &#39;t&#39; is not incident to the edge.">oppositeTriangle</a>(t);
<a name="l00381"></a>00381        <span class="keywordflow">if</span> (t &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t); todo.<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(t);}
<a name="l00382"></a>00382        collapses++;
<a name="l00383"></a>00383       }
<a name="l00384"></a>00384      }
<a name="l00385"></a>00385      <span class="keyword">delete</span>(vt);
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387    }
<a name="l00388"></a>00388   }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   <span class="keywordflow">if</span> (collapses) <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l00391"></a>00391   tcs += collapses; tcs += swaps;
<a name="l00392"></a>00392  } <span class="keywordflow">while</span> (collapses+swaps);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394  degn=0;
<a name="l00395"></a>00395  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>()) degn++;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397  <span class="keywordflow">if</span> (degn)
<a name="l00398"></a>00398  {
<a name="l00399"></a>00399   <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>()) <a class="code" href="../../d5/dc3/tin_8h.html#a1b11fa71b8a8bd4646866a8e7c3152c5">MARK_VISIT</a>(t); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t);
<a name="l00400"></a>00400   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;removeDegenerateTriangles: %d degeneracies couldn&#39;t be removed.\n&quot;</span>,degn);
<a name="l00401"></a>00401   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;removeDegenerateTriangles: and have been selected.\n&quot;</span>);
<a name="l00402"></a>00402   <span class="keywordflow">return</span> -tcs;
<a name="l00403"></a>00403  }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405  <span class="keywordflow">return</span> tcs;
<a name="l00406"></a>00406 }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="../../dc/d42/classTriangulation.html#a080843cfc9fe475455a291cad3c84edf">00412</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a080843cfc9fe475455a291cad3c84edf">Triangulation::removeSmallestComponents</a>()
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n,*m;
<a name="l00415"></a>00415  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo;
<a name="l00416"></a>00416  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> components;
<a name="l00417"></a>00417  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *component, *biggest = NULL;
<a name="l00418"></a>00418  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l00419"></a>00419  <span class="keywordtype">int</span> nt = 0, gnt = 0;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421  t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l00422"></a>00422  n = <a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>();
<a name="l00423"></a>00423  <span class="keywordflow">do</span>
<a name="l00424"></a>00424  {
<a name="l00425"></a>00425   component = <span class="keyword">new</span> <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a>;
<a name="l00426"></a>00426   components.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(component);
<a name="l00427"></a>00427   todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t);
<a name="l00428"></a>00428   <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00429"></a>00429   {
<a name="l00430"></a>00430    t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00431"></a>00431    todo.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>());
<a name="l00432"></a>00432    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t))
<a name="l00433"></a>00433    {
<a name="l00434"></a>00434     t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>();
<a name="l00435"></a>00435     t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>();
<a name="l00436"></a>00436     t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t1)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1);
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t2)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2);
<a name="l00440"></a>00440     <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t3)) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3);
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t);
<a name="l00443"></a>00443     component-&gt;<a class="code" href="../../d6/da9/classList.html#ab26b12640c866bafb29b03b2061cbd21" title="Appends a new node storing &#39;d&#39; to the tail.   O(1).">appendTail</a>(t);
<a name="l00444"></a>00444    }
<a name="l00445"></a>00445   }
<a name="l00446"></a>00446   todo.<a class="code" href="../../d6/da9/classList.html#aba50cb63a61052908a284d955a3862c6" title="Deletes and removes all the nodes.   O(numels()).">removeNodes</a>();
<a name="l00447"></a>00447   <span class="keywordflow">for</span> (; n != NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a2ee94e96b37e230872f96cc345f1cc44" title="Returns the next node in the list, possibly NULL.">next</a>()) {t = ((<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>); <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t)) <span class="keywordflow">break</span>;}
<a name="l00448"></a>00448  }
<a name="l00449"></a>00449  <span class="keywordflow">while</span> (n != NULL);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>(components, n)
<a name="l00452"></a>00452   <span class="keywordflow">if</span> ((nt = ((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>)-&gt;numels()) &gt; gnt) {gnt=nt; biggest = (<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;}
<a name="l00453"></a>00453 
<a name="l00454"></a>00454  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456  nt = 0;
<a name="l00457"></a>00457  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>(components, n)
<a name="l00458"></a>00458   <span class="keywordflow">if</span> (((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>) != biggest)
<a name="l00459"></a>00459    <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>(((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>), t, m)
<a name="l00460"></a>00460    {
<a name="l00461"></a>00461     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00462"></a>00462     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00464"></a>00464     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00465"></a>00465     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> != NULL) t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#aa927e66be3665a5382d4842567b99ee2" title="One of the incident edges.">e0</a> = NULL;
<a name="l00467"></a>00467     t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a> = NULL;
<a name="l00468"></a>00468     t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a> = NULL;
<a name="l00469"></a>00469     nt++;
<a name="l00470"></a>00470    }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472  <a class="code" href="../../da/d23/list_8h.html#ab9a7f4beb89fc089c9f4f43d60039ca8" title="Convenience macro to scan the nodes of a list.">FOREACHNODE</a>(components, n) <span class="keyword">delete</span>((<a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>);
<a name="l00473"></a>00473 
<a name="l00474"></a>00474  <span class="keywordflow">if</span> (nt)
<a name="l00475"></a>00475  {
<a name="l00476"></a>00476   <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00477"></a>00477   <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l00478"></a>00478   <span class="keywordflow">return</span> 1;
<a name="l00479"></a>00479  }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481  <span class="keywordflow">return</span> 0;
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 
<a name="l00487"></a>00487 
<a name="l00488"></a><a class="code" href="../../dc/d42/classTriangulation.html#a94a0f87022e174c1d0aae0da5ca2bd13">00488</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a94a0f87022e174c1d0aae0da5ca2bd13">Triangulation::forceNormalConsistence</a>()
<a name="l00489"></a>00489 {
<a name="l00490"></a>00490  <span class="keywordtype">int</span> ret = 0;
<a name="l00491"></a>00491  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00492"></a>00492  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t))
<a name="l00495"></a>00495   ret |= <a class="code" href="../../dc/d42/classTriangulation.html#a94a0f87022e174c1d0aae0da5ca2bd13">forceNormalConsistence</a>(t);
<a name="l00496"></a>00496  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00497"></a>00497  <span class="keywordflow">return</span> ret;
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00500"></a><a class="code" href="../../dc/d42/classTriangulation.html#a028f4bb4300855b6d1b80e9632bc8267">00500</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#a94a0f87022e174c1d0aae0da5ca2bd13">Triangulation::forceNormalConsistence</a>(<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t0)
<a name="l00501"></a>00501 {
<a name="l00502"></a>00502  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00503"></a>00503  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e;
<a name="l00504"></a>00504  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo, elist;
<a name="l00505"></a>00505  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *t1, *t2, *t3;
<a name="l00506"></a>00506  <span class="keywordtype">int</span> tmp1, tmp2, r=0, wrn = 0, isclosed = 1;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508  todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t0);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510  <span class="keywordflow">while</span> (todo.<a class="code" href="../../d6/da9/classList.html#abc03ea24209c4eb516e2505ef04f265f" title="Gets the number of elements.   O(1).">numels</a>())
<a name="l00511"></a>00511  {
<a name="l00512"></a>00512   t = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>()-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00513"></a>00513   todo.<a class="code" href="../../d6/da9/classList.html#af6a32880f6c3d84f82869c5976de1841" title="Deletes and removes the node &#39;n&#39; from the list.   O(1).">removeCell</a>(todo.<a class="code" href="../../d6/da9/classList.html#a88e46f0fb087e1ea7a2fa86c2d692fc2" title="Gets the first node, NULL if empty.   O(1).">head</a>());
<a name="l00514"></a>00514   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t))
<a name="l00515"></a>00515   {
<a name="l00516"></a>00516    t1 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a2d3123c04622f990608448cb41952207" title="First adjacent triangle. NULL if boundary.">t1</a>(); t2 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a1d8734dc47cdb2e317f04410576363" title="Second adjacent triangle. NULL if boundary.">t2</a>(); t3 = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac3c504a381fb0fc4c5393dc836ef1e1c" title="Third adjacent triangle. NULL if boundary.">t3</a>();
<a name="l00517"></a>00517    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>);}
<a name="l00518"></a>00518    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>);}
<a name="l00519"></a>00519    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>)) {<a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>); elist.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>);}
<a name="l00520"></a>00520 
<a name="l00521"></a>00521    <span class="keywordflow">if</span> (t1 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t1)) {todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t1); <span class="keywordflow">if</span> (!t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ab0f1bf66a268442532ccd86482d320cf" title="TRUE if the oriantation is consistent with the one of &#39;t&#39; OR if this and &#39;t&#39; do not share any edge...">checkAdjNor</a>(t1)) {t1-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a97fcb5e4aa239bc80ef8bbcfef0a9b3b" title="Inverts the orientation of the triangle.">invert</a>(); r=1;}}
<a name="l00522"></a>00522    <span class="keywordflow">if</span> (t2 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t2)) {todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t2); <span class="keywordflow">if</span> (!t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ab0f1bf66a268442532ccd86482d320cf" title="TRUE if the oriantation is consistent with the one of &#39;t&#39; OR if this and &#39;t&#39; do not share any edge...">checkAdjNor</a>(t2)) {t2-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a97fcb5e4aa239bc80ef8bbcfef0a9b3b" title="Inverts the orientation of the triangle.">invert</a>(); r=1;}}
<a name="l00523"></a>00523    <span class="keywordflow">if</span> (t3 != NULL &amp;&amp; !<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t3)) {todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(t3); <span class="keywordflow">if</span> (!t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ab0f1bf66a268442532ccd86482d320cf" title="TRUE if the oriantation is consistent with the one of &#39;t&#39; OR if this and &#39;t&#39; do not share any edge...">checkAdjNor</a>(t3)) {t3-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a97fcb5e4aa239bc80ef8bbcfef0a9b3b" title="Inverts the orientation of the triangle.">invert</a>(); r=1;}}
<a name="l00524"></a>00524 
<a name="l00525"></a>00525    <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(t);
<a name="l00526"></a>00526   }
<a name="l00527"></a>00527  }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529  <a class="code" href="../../df/d37/vertex_8h.html#a4bcf2ac8ba389be5ed1bf3a6cb5e0ca8" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of edges &#39;e&#39;.">FOREACHVEEDGE</a>((&amp;(elist)), e, n)
<a name="l00530"></a>00530  {
<a name="l00531"></a>00531   <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(e);
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (isclosed &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>()) isclosed = 0;
<a name="l00533"></a>00533   tmp1 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> != NULL)?((e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)?(-1):(1)):(0);
<a name="l00534"></a>00534   tmp2 = (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> != NULL)?((e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ae04b301dfba704f5a545b2e14874227a" title="Vertex shared with edge &#39;b&#39;. NULL if this and &#39;b&#39; do not share any vertex.">commonVertex</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e)) == e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)?(-1):(1)):(0);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536   <span class="keywordflow">if</span> (tmp1*tmp2 &lt; 0)
<a name="l00537"></a>00537   {
<a name="l00538"></a>00538    wrn++;
<a name="l00539"></a>00539    <span class="keywordflow">if</span> (tmp1 == -1) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l00540"></a>00540    <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *ne = <span class="keyword">new</span> <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>, e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>);
<a name="l00541"></a>00541    <a class="code" href="../../dc/d42/classTriangulation.html#a1116d0dcd5b4c67d7a7543b3c63e5c96" title="Edge set.">E</a>.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(ne);
<a name="l00542"></a>00542    e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a44240662b57bc9a1de0dab33c746ea7a" title="Replace edge &#39;a&#39; with edge &#39;b&#39; in the triangle and return TRUE. If &#39;a&#39; is not an edge of the triangle...">replaceEdge</a>(e, ne);
<a name="l00543"></a>00543    ne-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> = NULL;
<a name="l00544"></a>00544   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmp1 == -1 || tmp2 == -1) <a class="code" href="../../d3/da2/j__mesh_8h.html#a96b6af742bc069d3543013146e211fb2">p_swap</a>((<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>)), (<span class="keywordtype">void</span> **)(&amp;(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>)));
<a name="l00545"></a>00545  }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547  <span class="keywordflow">if</span> (wrn)
<a name="l00548"></a>00548  {
<a name="l00549"></a>00549   <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00550"></a>00550   <a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;forceNormalConsistence: Triangulation was not orientable. Cut performed.\n&quot;</span>);
<a name="l00551"></a>00551  }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553  <span class="keywordflow">if</span> (isclosed)
<a name="l00554"></a>00554  {
<a name="l00555"></a>00555   t = <a class="code" href="../../dc/d42/classTriangulation.html#ab202930f0c1041cdf2378ba30b7170a3" title="Return the triangle with the maximum &#39;z&#39; coordinate in the shell containing &#39;t0&#39;. O(N)...">topTriangle</a>(t0);
<a name="l00556"></a>00556   <span class="keywordflow">if</span> (t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6575384e5d5264a62cfa7c0ec98cd9ba" title="Return a normal vector with direction (v1-v2) cross (v2-v3). If triangle is degenerate return a null ...">getNormal</a>().<a class="code" href="../../dc/d4f/classPoint.html#ab977dbe4c9858624e5f1bf7e4603f58e" title="Coordinates.">z</a> &lt; 0) {<a class="code" href="../../dc/d42/classTriangulation.html#a49bd77069541bb23f87674e1cc6bb21a" title="Invert all the triangle and edge orientations. O(N).">flipNormals</a>(t0); r=1;}
<a name="l00557"></a>00557  }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559  <span class="keywordflow">return</span> r;
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 
<a name="l00563"></a>00563 <span class="comment">// If possible, swap edges to remove overlaps. When it is not</span>
<a name="l00564"></a>00564 <span class="comment">// enough, remove the overlapping triangles from the mesh.</span>
<a name="l00565"></a>00565 
<a name="l00566"></a><a class="code" href="../../dc/d42/classTriangulation.html#ae6e4787755d66d5e803770b99ca75513">00566</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#ae6e4787755d66d5e803770b99ca75513">Triangulation::removeOverlappingTriangles</a>()
<a name="l00567"></a>00567 {
<a name="l00568"></a>00568  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n;
<a name="l00569"></a>00569  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *ea;
<a name="l00570"></a>00570  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> oved;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n)
<a name="l00573"></a>00573   <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>)
<a name="l00574"></a>00574    oved.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(e);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576  oved.<a class="code" href="../../d6/da9/classList.html#af6153d20fae66c02dc243af901bdce35" title="Sorts the list using &#39;comp&#39; as comparison function for two elements.   O(numels()^2).">sort</a>(<a class="code" href="../../db/dc3/edge_8h.html#a71710b6e6999a79aa0d03010b6623a78" title="Edge comparison based on length to be used with jqsort() or abstractHeap.">edgeCompare</a>);
<a name="l00577"></a>00577 
<a name="l00578"></a>00578  <span class="keywordflow">for</span> (n=oved.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>(); n!=NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>())
<a name="l00579"></a>00579  {
<a name="l00580"></a>00580   e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00581"></a>00581   if (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>())
<a name="l00582"></a>00582   {
<a name="l00583"></a>00583    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>() || e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abe3766add2ba9ebd51cc5e15d86d8893" title="Degeneracy check. Return TRUE iff isCap() or isNeedle().">isDegenerate</a>()) {e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">continue</span>;}
<a name="l00584"></a>00584    ea = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e);
<a name="l00585"></a>00585    <span class="keywordflow">if</span> (!ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">continue</span>;}
<a name="l00586"></a>00586    ea = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e);
<a name="l00587"></a>00587    <span class="keywordflow">if</span> (!ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">continue</span>;}
<a name="l00588"></a>00588    ea = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(e);
<a name="l00589"></a>00589    <span class="keywordflow">if</span> (!ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">continue</span>;}
<a name="l00590"></a>00590    ea = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(e);
<a name="l00591"></a>00591    <span class="keywordflow">if</span> (!ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(ea-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#af7bb5960be35c8c7e7e9484e930926d0" title="Combinatorial edge-swap.">swap</a>(1); <span class="keywordflow">continue</span>;}
<a name="l00592"></a>00592   }
<a name="l00593"></a>00593  }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595  <span class="keywordflow">for</span> (n=oved.<a class="code" href="../../d6/da9/classList.html#ad2dee0e28745416172149fcd6302b818" title="Gets the last node, NULL if empty.   O(1).">tail</a>(); n!=NULL; n=n-&gt;<a class="code" href="../../df/dd0/classNode.html#a6690bb993e281cb8ea1f7e8be1fdcb22" title="Returns the previous node in the list, possibly NULL.">prev</a>())
<a name="l00596"></a>00596  {
<a name="l00597"></a>00597   e = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)n-&gt;<a class="code" href="../../df/dd0/classNode.html#a38b733496e3eff5e0b4fcb11cd9b866a" title="Actual data stored in the node.">data</a>;
<a name="l00598"></a>00598   if (!e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a2aa28fac7c5299853aa683c744853d5b" title="TRUE iff edge is on the boundary (i.e., one of the two incident triangles is NULL).">isOnBoundary</a>() &amp;&amp; e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac79934be803387dfceb647c00978f1ef" title="Angle between the normal vector of this and the one of &#39;t&#39;. Return -1 if one or both the triangles ar...">getDAngle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>) == <a class="code" href="../../d3/da2/j__mesh_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {<a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>); <a class="code" href="../../dc/d42/classTriangulation.html#a69d233a34aaa2b3a343ef1f2bc5d1012" title="Unlinks a triangle from the mesh. O(1).">unlinkTriangle</a>(e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);}
<a name="l00599"></a>00599  }
<a name="l00600"></a>00600  <a class="code" href="../../dc/d42/classTriangulation.html#a9825e73a6c955c508e2de136ded7a4b3" title="Removes all the unlinked elements from the lists. Returns the number of removed elements. O(N).">removeUnlinkedElements</a>();
<a name="l00601"></a>00601  <a class="code" href="../../dc/d42/classTriangulation.html#ab811fee3e2d1dd73215f8cc60674d410" title="Dirty bit for n_boundaries.">d_boundaries</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a99ef243e4fd278723ebecc712b47d7f7" title="Dirty bit for n_handles.">d_handles</a> = <a class="code" href="../../dc/d42/classTriangulation.html#a07cf7ce1886eb2f34fd8db5571527b77" title="Dirty bit for n_shells.">d_shells</a> = 1;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603  <span class="keywordflow">return</span> 0;
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00608"></a>00608 
<a name="l00609"></a><a class="code" href="../../dc/d42/classTriangulation.html#abd746c6f132a315f7556cdb9fc23b537">00609</a> <span class="keywordtype">int</span> <a class="code" href="../../dc/d42/classTriangulation.html#abd746c6f132a315f7556cdb9fc23b537">Triangulation::selectTinyHandles</a>(<span class="keywordtype">double</span> L)
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611  <span class="keywordflow">if</span> (<a class="code" href="../../dc/d42/classTriangulation.html#af06a73bd1d73fea08bd6893f9b253ba5" title="Get the number of connected components of the triangle mesh. O(1) or O(N).">shells</a>() &gt; 1) {<a class="code" href="../../d3/dab/classJMesh.html#ac79ec04bc1e859a5cc3deefebaddb0fc">JMesh::warning</a>(<span class="stringliteral">&quot;Sorry. This feature was not implemented for multi-component meshes.\n&quot;</span>); <span class="keywordflow">return</span> 1;}
<a name="l00612"></a>00612 
<a name="l00613"></a>00613  <span class="keywordtype">int</span> bdrr, nh = 0;
<a name="l00614"></a>00614  <a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *t, *lt, *rt;
<a name="l00615"></a>00615  <a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *e, *se, *le, *re, *gate = NULL;
<a name="l00616"></a>00616  <a class="code" href="../../d2/da0/classVertex.html" title="Vertex of a Triangulation.">Vertex</a> *v, *ov;
<a name="l00617"></a>00617  <a class="code" href="../../df/dd0/classNode.html" title="Generic node of a doubly likned list.">Node</a> *n, *m;
<a name="l00618"></a>00618 
<a name="l00619"></a>00619  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n)
<a name="l00620"></a>00620   <span class="keywordflow">if</span> (!t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#a48bf625b550d53b26111b2cd12d4ebc3" title="TRUE iff vertex is on boundary.">isOnBoundary</a>() &amp;&amp; !t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#a48bf625b550d53b26111b2cd12d4ebc3" title="TRUE iff vertex is on boundary.">isOnBoundary</a>() &amp;&amp; !t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#a48bf625b550d53b26111b2cd12d4ebc3" title="TRUE iff vertex is on boundary.">isOnBoundary</a>()) <span class="keywordflow">break</span>;
<a name="l00621"></a>00621  <span class="keywordflow">if</span> (n==NULL) <span class="keywordflow">return</span> 1;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623  <a class="code" href="../../dc/d42/classTriangulation.html#af82942f087840e0773a31ab38c4997ba" title="Unmark all the elements. O(N).">unmarkEverything</a>();
<a name="l00624"></a>00624  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = 1;
<a name="l00625"></a>00625  t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = 1;
<a name="l00626"></a>00626  <a class="code" href="../../d6/da9/classList.html" title="Doubly linked list.">List</a> todo((gate = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>));
<a name="l00627"></a>00627 
<a name="l00628"></a>00628  <span class="keywordflow">while</span> ((gate = (<a class="code" href="../../d8/d8c/classEdge.html" title="Edge of a Triangulation.">Edge</a> *)todo.<a class="code" href="../../d6/da9/classList.html#a8167cffb890b7c640c1f0af7bbc67dd9" title="Deletes and removes the first node. Returns its data.   O(1).">popHead</a>()) != NULL)
<a name="l00629"></a>00629  {
<a name="l00630"></a>00630   <span class="keywordflow">while</span>(1)
<a name="l00631"></a>00631   {
<a name="l00632"></a>00632    bdrr = 0;
<a name="l00633"></a>00633    t = (gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a> == NULL || gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>)?((gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a> == NULL || gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>)?(NULL):(gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>)):(gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>);
<a name="l00634"></a>00634    <span class="keywordflow">if</span> (t == NULL)
<a name="l00635"></a>00635    {
<a name="l00636"></a>00636     <span class="keywordflow">if</span> (gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>) <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a587b8b9bcd58f28cfc3ab86541f1b171">t1</a>); <span class="keywordflow">else</span> <a class="code" href="../../d5/dc3/tin_8h.html#a359323af5e2024df675253fcc1631230">MARK_VISIT2</a>(gate-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a13e9eb8c44b489e1027575365be4542a" title="Incident triangles.">t2</a>);
<a name="l00637"></a>00637     nh++;
<a name="l00638"></a>00638     <span class="keywordflow">break</span>;
<a name="l00639"></a>00639    }
<a name="l00640"></a>00640    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> = 1; t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ac9f75ea4f440c5be9830d5b200b2d612">e1</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#adacb4743de924b00b5a72ce49783e415">e2</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#aa99673837990e30ca642382aa59dcff6" title="Edges of the triangle.">e3</a>-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = 1;
<a name="l00641"></a>00641    le = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#abf510b439d584050a9067f6ce411ca80" title="Edge preceeding &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">prevEdge</a>(gate);
<a name="l00642"></a>00642    re = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a0441cc1008dffcfa2b61c3ddf8b22f49" title="Edge next to &#39;e&#39; in the ordering or the triangle. NULL if &#39;e&#39; is not an edge of the triangle...">nextEdge</a>(gate);
<a name="l00643"></a>00643    lt = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a738058575f00e6e2106cd93c9b198612" title="Triangle adjacent to the previous edge of &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">leftTriangle</a>(gate);
<a name="l00644"></a>00644    rt = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a9d9125568447b7d2619617a8e04be6b9" title="Triangle adjacent to the next edge of &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">rightTriangle</a>(gate);
<a name="l00645"></a>00645    ov = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ae067272a5f326d48edddbfe3395b6e5f" title="Triangle&#39;s vertex opposite to &#39;e&#39;. NULL if &#39;e&#39; is not an edge of the triangle.">oppositeVertex</a>(gate);
<a name="l00646"></a>00646    <span class="keywordflow">if</span> (lt &amp;&amp; rt &amp;&amp; !lt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> &amp;&amp; !rt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a> &amp;&amp; !ov-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> &amp;&amp; ov-&gt;<a class="code" href="../../d2/da0/classVertex.html#a48bf625b550d53b26111b2cd12d4ebc3" title="TRUE iff vertex is on boundary.">isOnBoundary</a>())
<a name="l00647"></a>00647    {
<a name="l00648"></a>00648     bdrr = 1;
<a name="l00649"></a>00649     e = se = ov-&gt;<a class="code" href="../../d2/da0/classVertex.html#a84156dc9fa2fb7987ced9461d3cb490b" title="Returns the edge following this vertex on the boundary.">nextBoundaryEdge</a>();
<a name="l00650"></a>00650     v = ov;
<a name="l00651"></a>00651     <span class="keywordflow">do</span>
<a name="l00652"></a>00652     {
<a name="l00653"></a>00653      e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ab13004e9c8ac958d35a8e3317d9090c9" title="bit-mask for marking purposes">mask</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#ad3e7269be80d034e23b08d1f754fe0ca">v1</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a70cb184e773ada91ada89b7c9728e8ef" title="End-points.">v2</a>-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = 1;
<a name="l00654"></a>00654      v = e-&gt;<a class="code" href="../../d8/d8c/classEdge.html#a5e27c1e4f741d220496ae61e18e8be3c" title="Vertex opposite to &#39;v&#39;. NULL if &#39;v&#39; is not a vertex of the edge.">oppositeVertex</a>(v);
<a name="l00655"></a>00655      e = v-&gt;<a class="code" href="../../d2/da0/classVertex.html#a84156dc9fa2fb7987ced9461d3cb490b" title="Returns the edge following this vertex on the boundary.">nextBoundaryEdge</a>();
<a name="l00656"></a>00656     } <span class="keywordflow">while</span> (e != se);
<a name="l00657"></a>00657    }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659    <span class="keywordflow">if</span> (ov-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a>)
<a name="l00660"></a>00660    {
<a name="l00661"></a>00661     <span class="keywordflow">if</span> ((!lt || lt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>) &amp;&amp; (!rt || rt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>)) <span class="keywordflow">break</span>;  <span class="comment">// E</span>
<a name="l00662"></a>00662     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!lt || lt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>)) gate = re;      <span class="comment">// L</span>
<a name="l00663"></a>00663     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!rt || rt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a6c8cb70732c338195de073f3185d98e6" title="bit-mask for marking purposes">mask</a>)) gate = le;      <span class="comment">// R</span>
<a name="l00664"></a>00664     <span class="keywordflow">else</span> {<span class="keywordflow">if</span> (!bdrr) todo.<a class="code" href="../../d6/da9/classList.html#a9f4271a0089b532e0b3ea0c74a1d177f" title="Appends a new node storing &#39;d&#39; to the head.   O(1).">appendHead</a>(le); gate = re;}   <span class="comment">// S</span>
<a name="l00665"></a>00665    }
<a name="l00666"></a>00666    <span class="keywordflow">else</span> gate = re;                  <span class="comment">// C</span>
<a name="l00667"></a>00667 
<a name="l00668"></a>00668    t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a5a7a50878cb130f56a3b8a36ab0a5fb7" title="First vertex.">v1</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a87e3655f517243d11e6920e5a99837c0" title="Second vertex.">v2</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#ad9ac6a1add0fb55edc6d5372c3ceec69" title="Third vertex.">v3</a>()-&gt;<a class="code" href="../../d2/da0/classVertex.html#ae37fea0f24b2ee81a6a51fb4a9cb6854" title="bit-mask for marking purposes">mask</a> = 1;
<a name="l00669"></a>00669   }
<a name="l00670"></a>00670  }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672  nh /= 2;
<a name="l00673"></a>00673 
<a name="l00674"></a>00674  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(t);
<a name="l00675"></a>00675  <a class="code" href="../../d5/dc3/tin_8h.html#ae6fc840f70402960f01192dbf686da17">FOREACHEDGE</a>(e, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(e);
<a name="l00676"></a>00676  <a class="code" href="../../d5/dc3/tin_8h.html#a1d4432b68970d3249538dbc20279e469">FOREACHVERTEX</a>(v, n) <a class="code" href="../../d5/dc3/tin_8h.html#a9e965d17b4e67b0db098523fc8454387">UNMARK_VISIT</a>(v);
<a name="l00677"></a>00677 
<a name="l00678"></a>00678  <a class="code" href="../../dc/d4f/classPoint.html" title="Geometric point definition.">Point</a> center;
<a name="l00679"></a>00679  <a class="code" href="../../dc/d42/classTriangulation.html" title="Triangulation.">Triangulation</a> *stin;
<a name="l00680"></a>00680  <span class="keywordtype">int</span> sh=0;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t))
<a name="l00683"></a>00683  {
<a name="l00684"></a>00684   center = t-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a75ccdf1d5198ab4fadd20e37af746ec8" title="Return the triangle&#39;s barycenter.">getCenter</a>();
<a name="l00685"></a>00685   <a class="code" href="../../dc/d42/classTriangulation.html#a7a3755242ac31162d7f5e274b199a3e7" title="Marks all the triangles within distance L from &#39;p&#39; as selected. O(output).">selectSphericalRegion</a>(t, L, &amp;center);
<a name="l00686"></a>00686  }
<a name="l00687"></a>00687 
<a name="l00688"></a>00688  <a class="code" href="../../d5/dc3/tin_8h.html#aa3f879c6916e3c7170ceac09181d4e49">FOREACHTRIANGLE</a>(t, n) <span class="keywordflow">if</span> (<a class="code" href="../../d5/dc3/tin_8h.html#a5645cfda09621f82e4a10c2330f7624f">IS_VISITED2</a>(t))
<a name="l00689"></a>00689  {
<a name="l00690"></a>00690   <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(t);
<a name="l00691"></a>00691   <span class="keywordflow">if</span> ((stin = <a class="code" href="../../dc/d42/classTriangulation.html#a1b01a95f2a5f2339a7adb94613fbf6e1" title="Creates a new Triangulation out of an existing selection containing &#39;t0&#39;. O(output).">createSubMeshFromSelection</a>(t)) != NULL)
<a name="l00692"></a>00692   {
<a name="l00693"></a>00693    <span class="keywordflow">if</span> (stin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a0e75501a03e2f163f5eefc2d2d7099e0" title="Get the number of handles of the triangle mesh. O(1) or O(N).">handles</a>() &lt; 1) <a class="code" href="../../dc/d42/classTriangulation.html#a12d7b202b70c8ddba10f5d78a1428ceb" title="Inverts the selection status of all the triangles. O(N).">invertSelection</a>(t);
<a name="l00694"></a>00694    <span class="keywordflow">else</span>
<a name="l00695"></a>00695    {
<a name="l00696"></a>00696     sh += stin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#a0e75501a03e2f163f5eefc2d2d7099e0" title="Get the number of handles of the triangle mesh. O(1) or O(N).">handles</a>();
<a name="l00697"></a>00697     <a class="code" href="../../df/d37/vertex_8h.html#aa159c5591e2542341f17ecc88cff1f07" title="Scans the nodes &#39;n&#39; of a list &#39;l&#39; of triangles &#39;t&#39;.">FOREACHVTTRIANGLE</a>((&amp;(stin-&gt;<a class="code" href="../../dc/d42/classTriangulation.html#aa4c07e0c87b09b4ef469b969ccf469d2" title="Triangle set.">T</a>)), lt, m) {rt = (<a class="code" href="../../d2/d51/classTriangle.html" title="Triangle of a Triangulation.">Triangle</a> *)lt-&gt;<a class="code" href="../../d2/d51/classTriangle.html#a4c6f4beb64dfea01b7459294d09c1ccf" title="Further information.">info</a>; <a class="code" href="../../d5/dc3/tin_8h.html#aa4cf77805698a9c3e14d4a10e6f96da0">UNMARK_VISIT2</a>(rt);}
<a name="l00698"></a>00698    }
<a name="l00699"></a>00699    <span class="keyword">delete</span>(stin);
<a name="l00700"></a>00700   }
<a name="l00701"></a>00701  }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;Selected %d out of %d handles\n&quot;</span>,sh,nh);
<a name="l00704"></a>00704  <a class="code" href="../../d3/dab/classJMesh.html#a08a2c6222bd080ef8777c7ad96a8a052">JMesh::info</a>(<span class="stringliteral">&quot;Radius: %f\n&quot;</span>,L);
<a name="l00705"></a>00705 
<a name="l00706"></a>00706  <span class="keywordflow">return</span> 0;
<a name="l00707"></a>00707 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dc/d1d/checkAndRepair_8cpp.html">checkAndRepair.cpp</a>      </li>
      <li class="footer">Generated on Mon Feb 4 2013 11:36:19 for OpenCog Framework by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
